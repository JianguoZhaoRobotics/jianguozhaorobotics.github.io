{"version":3,"kind":"Notebook","sha256":"b180ef9293b2e006727a8d7551184f19366e3dafb62acc6ec9fbb34d4c3e5254","slug":"mech529-finalproject-acrobot","location":"/MECH529_FinalProject_Acrobot.ipynb","dependencies":[],"frontmatter":{"title":"Final Project","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3"},"authors":[{"nameParsed":{"literal":"Jianguo Zhao","given":"Jianguo","family":"Zhao"},"name":"Jianguo Zhao","affiliations":["Department of Mechanical Engineering, Colorado State University"],"id":"contributors-Users\\jguoz\\OneDrive - Colostate\\Teaching\\MECH 529 Advanced Mechanical Systems\\2025 Fall\\Lab\\All Labs\\myst-generated-uid-0"}],"github":"https://github.com/YOUR_USERNAME/YOUR_REPO","copyright":"2025","affiliations":[{"id":"Department of Mechanical Engineering, Colorado State University","name":"Department of Mechanical Engineering, Colorado State University"}],"thumbnail":"/8dbf0df5415f14ad64436613313eaaeb.gif","exports":[{"format":"ipynb","filename":"MECH529_FinalProject_Acrobot.ipynb","url":"/MECH529_FinalProject-a2f735376f7e4db233a93b095eb5a76b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"id":"29d496f5"},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Model-Based and Reinforcement Learning Control of the Acrobot","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kc2L0JGBZJ"}],"key":"oee4coQviZ"},{"type":"thematicBreak","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SZ8zOMu3AT"},{"type":"heading","depth":3,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Project Overview","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jxyWcLn7bQ"}],"identifier":"project-overview","label":"Project Overview","html_id":"project-overview","implicit":true,"key":"mjTjFNx0nT"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"In this final project, you will apply various concepts learned in this course to a ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"E3jkTIVHpb"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"single underactuated dynamic system","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"meAtKePoQR"}],"key":"G7pQXGHwYl"},{"type":"text","value":": the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"vJuTQ0a9vW"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Acrobot","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"GkTBNotaUp"}],"key":"fvF7ldvVLO"},{"type":"text","value":" (a two-link pendulum with an actuator only at the second joint). This project integrates all the tools explored in the labs, providing a comprehensive comparison between ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"EDpcHgtnlf"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"model-based control","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fr4chtjZU4"}],"key":"eMsK5TqwFb"},{"type":"text","value":" and ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oBZBmEoWSg"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"learning-based control","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"nez9UaMq40"}],"key":"nP1x33C2cu"},{"type":"text","value":" approaches.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"aD5xyWCS4L"}],"key":"WGxXhLXHvZ"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Specifically, you will:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tuzwjoA7Y6"}],"key":"RF7ezyImEg"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Derive and linearize the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"armWhTgWov"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"continuous-time dynamics","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"lSdFGmXC8d"}],"key":"SfulsvmMbS"},{"type":"text","value":" of the Acrobot.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"k426voVvrn"}],"key":"UZYUBZdnvL"}],"key":"Zl7PhmMrD3"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Design ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"NQoAt4GkB1"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"state-feedback","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Hw7mqlwCYw"}],"key":"R1wa5pLFw7"},{"type":"text","value":" and ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"QoYXCvFhtN"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"LQR","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"UY9aDTNDVW"}],"key":"aqbfOvsgez"},{"type":"text","value":" controllers for stabilization.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"kT1Wm0i7Li"}],"key":"UHupSTeO5T"}],"key":"n8irSOyzsT"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Perform ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"OHTI1sspKK"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"trajectory generation","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"b6neQnBOja"}],"key":"y1Maats9n1"},{"type":"text","value":" (e.g., swing-up trajectory)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"xF7l50Jk3m"}],"key":"nklyM9zbdP"}],"key":"mOnKtTOD8o"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Perform ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"nOwS2fCAHR"},{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"trajectory tracking","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"N1Jwsv2aaC"}],"key":"EU8CCrmZFU"},{"type":"text","value":" (via MPC).","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"iv8OJDoUrt"}],"key":"IteRRITn0K"}],"key":"zRsjlcFHMh"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Implement a ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Jlquvudid4"},{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Reinforcement Learning (RL)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"OiPwO2IIvA"}],"key":"uwPvkX9q1t"},{"type":"text","value":" controller for the ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"EkzsYASpji"},{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Gymnasium ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"f8U0rlo9WY"},{"type":"inlineCode","value":"Acrobot-v1","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"lFskLI3t7j"},{"type":"text","value":" environment","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Fw71J4Qgma"}],"key":"IFRWsHyGcR"},{"type":"text","value":".","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"MROzpLMwek"}],"key":"lcDmNZBMSi"}],"key":"ylJ35CaNE3"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compare the ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"rkWA0emEo1"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"model-based","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ZRrLIGBWiY"}],"key":"tisEn2dTDt"},{"type":"text","value":" and ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"yhbatWRUPB"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"RL-based","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"k3ZXbqeUUZ"}],"key":"WPUwK4q2sh"},{"type":"text","value":" controllers using common performance metrics.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"KaO7D69GEd"}],"key":"oozyxAkAtc"}],"key":"GDYWZhyOd3"}],"key":"HPXolaKzgp"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"The final project is individual. You should submit:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"R0x2NjeSXl"}],"key":"UhUOHjN8pG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This completed notebook (with code and plots).","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"tnULkkyYye"}],"key":"Fq1GWOKysW"}],"key":"FG2B5tGgVc"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A short written report summarizing methods and results.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"LgbrqgrnT1"}],"key":"axRpUirS2u"}],"key":"QiMv9utkFP"}],"key":"rejAIOPDBt"},{"type":"thematicBreak","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"mUmyl8uJsk"},{"type":"heading","depth":3,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Introduction to Acrobot system","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"dbot11fDXI"}],"identifier":"introduction-to-acrobot-system","label":"Introduction to Acrobot system","html_id":"introduction-to-acrobot-system","implicit":true,"key":"JT5MAcWXf9"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"The Acrobot is a classic underactuated system. It is a planar two-link robotic arm in the vertical plane (working against gravity), with an actuator at the elbow, but no actuator at the shoulder. The Acrobot is so named because of its resemblance to a gymnast (or acrobat) on a parallel bar, who controls his/her motion predominantly by effort at the waist (and not effort at the wrist). The control goal is typically to swing the Acrobot up from a hanging position to an inverted, balanced position. You may watch a video for the acrobot here.\n","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ZAS1UxCQiT"},{"type":"link","url":"https://www.youtube.com/watch?v=FeCwtvrD76I","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Acrobot swing up and stabilization","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"BtjSJRwXvb"}],"urlSource":"https://www.youtube.com/watch?v=FeCwtvrD76I","key":"Vt2qSalaet"},{"type":"text","value":". A recent physical AI competition using acrobot can be found here:\n","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ufBd96Dpr0"},{"type":"link","url":"https://ai-olympics.dfki-bremen.de/","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"AI Olympics","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"wAtZScTsjt"}],"urlSource":"https://ai-olympics.dfki-bremen.de/","key":"VzOb8Tyzod"}],"key":"InCINGWtu5"},{"type":"image","url":"/8dbf0df5415f14ad64436613313eaaeb.gif","alt":"Acrobot","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"GckEamzxEH","urlSource":"https://ai-olympics.dfki-bremen.de/wp-content/uploads/2024/06/video-5.gif"},{"type":"heading","depth":3,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"System and Tools","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"vLkNzIxNBk"}],"identifier":"system-and-tools","label":"System and Tools","html_id":"system-and-tools","implicit":true,"key":"qNXCzrFtm2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":36,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"System:","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"NgqECfk1Gx"}],"key":"ZEifivJsPI"},{"type":"text","value":" Acrobot (two-link underactuated pendulum)","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"XH6BUNYyAS"}],"key":"clm1TwA52u"}],"key":"RlK5Q666tx"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Model-based control:","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"hlkGvmVHMy"}],"key":"NdZ5McFnEK"},{"type":"text","value":" ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"O85XdrYaZm"},{"type":"inlineCode","value":"numpy","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"Oduf9BtQGd"},{"type":"text","value":", ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"zIPLpAlXK5"},{"type":"inlineCode","value":"scipy","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"qimdxQHd2H"},{"type":"text","value":", ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"OaVpqTgwci"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"pM9XakXJNc"},{"type":"text","value":", ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"sbt7371c0R"},{"type":"inlineCode","value":"python-control","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"c07hfD5cdf"},{"type":"text","value":" (LQR)","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"HT3ZyvIhEc"}],"key":"Lv7hYx3u43"}],"key":"hnv4Gwjtbh"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Trajectory optimization / MPC:","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"jHWI1XYMy1"}],"key":"bguHEIjipT"},{"type":"text","value":" ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"npyWkysonA"},{"type":"inlineCode","value":"python-control","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"lE58U2Yq9p"}],"key":"vaCB9llrnO"}],"key":"x9ovMl9V1o"},{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Reinforcement Learning:","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"B9876RmZyb"}],"key":"KiFBib6hcy"},{"type":"text","value":" ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"pOTe4sEMOR"},{"type":"inlineCode","value":"gymnasium","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"hcAkeBC99X"},{"type":"text","value":" (Acrobot-v1), ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"iC318ID7Ff"},{"type":"inlineCode","value":"stable-baselines3","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"xNPlmPNE8V"},{"type":"text","value":" (PPO)","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"GTcyZ67fdY"}],"key":"GQmWPxhO8B"}],"key":"RIZeBEzCBs"}],"key":"j1uas0ENNx"}],"identifier":"29d496f5","label":"29d496f5","html_id":"id-29d496f5","key":"HrNvGhLHMa"},{"type":"block","kind":"notebook-content","data":{"id":"555150b1"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 0. Setup","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rVO43rO4li"}],"identifier":"task-0-setup","label":"Task 0. Setup","html_id":"task-0-setup","implicit":true,"key":"WMxJ5WxwdN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Run this cell to import packages and (optionally) install extra dependencies.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H5yjtzPWqb"}],"key":"QAE950ZLF7"}],"identifier":"555150b1","label":"555150b1","html_id":"id-555150b1","key":"cRmaZqI3Rr"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16353,"status":"ok","timestamp":1765082656482,"user":{"displayName":"Jianguo Zhao","userId":"09996222056778326224"},"user_tz":420},"id":"a69315cd","outputId":"6b2aaba7-4834-447b-ae25-cf23f5e24e18"},"children":[{"type":"code","lang":"python","executable":true,"value":"# Install dependencies for Colab\n%pip install -q control gymnasium stable-baselines3[extra] scipy matplotlib\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# For numerical integration\ntry:\n    import scipy as sp\n    from scipy.integrate import solve_ivp\nexcept ImportError:\n    %pip install scipy\n    import scipy as sp\n    from scipy.integrate import solve_ivp\n\n# For control systems\ntry:\n    import control as ctl\n    print(f\"control already installed: {ctl.__version__}\")\nexcept ImportError:\n    %pip install control\n    import control as ctl\n\n# For RL APIs\ntry:\n    import gymnasium as gym\n    print(f\"gymnasium already installed: {gym.__version__}\")\nexcept ImportError:\n    %pip install gymnasium\n    import gymnasium as gym\n\n# For RL algorithms\ntry:\n    import stable_baselines3 as sb3\n    print(f\"stable_baselines3 already installed: {sb3.__version__}\")\nexcept ImportError:\n    %pip install stable-baselines3\n    import stable_baselines3 as sb3\n\n# For visualization\ntry:\n    import pygame\n    print(f\"pygame already installed: {pygame.__version__}\")\nexcept ImportError:\n    %pip install pygame\n\n# Set default plotting style\nplt.style.use(\"ggplot\")","identifier":"a69315cd-code","enumerator":"1","html_id":"a69315cd-code","key":"hRqZXysrwW"},{"type":"outputs","id":"PXjY6tldFSqFNxweVG6EZ","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\u001b[?25l   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/578.3 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K   \u001b[91m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[91m╸\u001b[0m \u001b[32m573.4/578.3 kB\u001b[0m \u001b[31m22.8 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m578.3/578.3 kB\u001b[0m \u001b[31m15.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25h\u001b[?25l   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/188.0 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m188.0/188.0 kB\u001b[0m \u001b[31m18.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hcontrol already installed: 0.10.2\ngymnasium already installed: 1.2.2\n"},"children":[],"identifier":"a69315cd-outputs-0","html_id":"a69315cd-outputs-0","key":"TflwmN4KEv"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.\nPlease upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.\nSee the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.\n"},"children":[],"identifier":"a69315cd-outputs-1","html_id":"a69315cd-outputs-1","key":"BjVN5P8Dyd"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"stable_baselines3 already installed: 2.7.1\npygame already installed: 2.6.1\n"},"children":[],"identifier":"a69315cd-outputs-2","html_id":"a69315cd-outputs-2","key":"LU5Z0R9Xra"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/usr/local/lib/python3.12/dist-packages/jupyter_client/session.py:203: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  return datetime.utcnow().replace(tzinfo=utc)\n/usr/local/lib/python3.12/dist-packages/pygame/pkgdata.py:25: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import resource_stream, resource_exists\n/usr/local/lib/python3.12/dist-packages/pkg_resources/__init__.py:3154: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.\nImplementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n  declare_namespace(pkg)\n/usr/local/lib/python3.12/dist-packages/pkg_resources/__init__.py:3154: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\nImplementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n  declare_namespace(pkg)\n/usr/local/lib/python3.12/dist-packages/pkg_resources/__init__.py:3154: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sphinxcontrib')`.\nImplementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n  declare_namespace(pkg)\n/usr/local/lib/python3.12/dist-packages/jupyter_client/session.py:203: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  return datetime.utcnow().replace(tzinfo=utc)\n"},"children":[],"identifier":"a69315cd-outputs-3","html_id":"a69315cd-outputs-3","key":"hah9VbvHYT"}],"identifier":"a69315cd-outputs","html_id":"a69315cd-outputs","key":"VNl3EueOmz"}],"identifier":"a69315cd","label":"a69315cd","html_id":"a69315cd","key":"mx5vvUJWHY"},{"type":"block","kind":"notebook-content","data":{"id":"755ca7e0"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 1. Acrobot Dynamics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AEugGjODtD"}],"identifier":"task-1-acrobot-dynamics","label":"Task 1. Acrobot Dynamics","html_id":"task-1-acrobot-dynamics","implicit":true,"key":"V33YiRcbMF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this task, we will establish the dynamics model for all the following tasks. Note the solution for this task is provided so that everyone is the on the same page. The system is shown in the following figure","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t0b3oHc8sL"}],"key":"xcDbA1p9ap"},{"type":"image","url":"/43d76c9177b48e4cced8a8ccf63eeacd.svg","alt":"image.png","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FviVjpUndT","urlSource":"https://underactuated.csail.mit.edu/figures/acrobot.svg"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"For the system, we define the state as:\n$$\nx =","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aNvDTpMyj6"}],"key":"kso91uz1rc"},{"type":"math","value":"\\begin{bmatrix}\n\\theta_1, \\theta_2, \\dot{\\theta}_1, \\dot{\\theta}_2\n\\end{bmatrix}","tight":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>θ</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mover accent=\"true\"><mi>θ</mi><mo>˙</mo></mover><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mover accent=\"true\"><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n\\theta_1, \\theta_2, \\dot{\\theta}_1, \\dot{\\theta}_2\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2913em;vertical-align:-0.3957em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8957em;\"><span style=\"top:-2.9644em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0556em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0556em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3957em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span></span></span></span></span>","enumerator":"1","key":"SW8i6XVZWL"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"$$\nwhere:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Mm4SskVAJD"}],"key":"AvXFDlGUsr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\theta_1","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\theta_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WhljAOjkfe"},{"type":"text","value":" is the angle of the first link from the vertical","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"W1Dt7n5t8t"}],"key":"Nt3cdF9CGY"}],"key":"aljGKZr0Z2"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\theta_2","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\theta_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"xB4KKTdeTx"},{"type":"text","value":" is the relative angle of the second link with respect to the first","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pVphelQH7e"}],"key":"VKaw7DvrqJ"}],"key":"D6seNfstHS"}],"key":"a0rzMbU52H"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"The control input is the torque applied at joint 2:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"sOyUt0WYbc"}],"key":"KHkLwoPkor"},{"type":"math","value":"u =\\tau \\in \\mathbb{R}","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>u</mi><mo>=</mo><mi>τ</mi><mo>∈</mo><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">u =\\tau \\in \\mathbb{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span></span>","enumerator":"2","key":"fG6R1qOy1s"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"We have the following constant parameters","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"yZ4pCkTZpn"}],"key":"elVBHXSuHx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"m_1, m_2","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">m_1, m_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PBzPXgfz1I"},{"type":"text","value":": link masses","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"kbV9Poo8Fo"}],"key":"YfvAXfrOwm"}],"key":"MzrROyELZA"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"l_1","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>l</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">l_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TAI0gFCwCn"},{"type":"text","value":": length of link 1","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"S1AAm6LwY9"}],"key":"WpU2J0CWfE"}],"key":"FfCLRBslh0"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"l_{c1}, l_{c2}","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>l</mi><mrow><mi>c</mi><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><msub><mi>l</mi><mrow><mi>c</mi><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">l_{c1}, l_{c2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wTaxzZvf4t"},{"type":"text","value":": Center of Mass (COM) distances","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"xI9AaE0x8F"}],"key":"JFu0zlBAPD"}],"key":"emBycRWmeF"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"I_1, I_2","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>I</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">I_1, I_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"aDVO5Qryvv"},{"type":"text","value":": moments of inertia","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"AzgVqrxXVT"}],"key":"jakjJp51XS"}],"key":"I2PIZS3VOJ"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"g","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"Dp5PMwroKN"},{"type":"text","value":": gravity","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"aCdpOp2nMT"}],"key":"T2mBk2q0Ws"}],"key":"o41DJiMnw4"}],"key":"EGi3G4cCWU"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"The dynamics equation in state-space form can be written as\n$$\n\\dot{x} =","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"eQthMxQVMF"}],"key":"E9j2QV3sIU"},{"type":"math","value":"\\begin{bmatrix}\n\\dot{\\theta}_1 \\\\\n\\dot{\\theta}_2 \\\\\n\\ddot{\\theta}_1 \\\\\n\\ddot{\\theta}_2\n\\end{bmatrix}","tight":true,"position":{"start":{"line":33,"column":1},"end":{"line":37,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mover accent=\"true\"><mi>θ</mi><mo>˙</mo></mover><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mover accent=\"true\"><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mover accent=\"true\"><mi>θ</mi><mo>¨</mo></mover><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mover accent=\"true\"><mi>θ</mi><mo>¨</mo></mover><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n\\dot{\\theta}_1 \\\\\n\\dot{\\theta}_2 \\\\\n\\ddot{\\theta}_1 \\\\\n\\ddot{\\theta}_2\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:5.1652em;vertical-align:-2.3326em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.8326em;\"><span style=\"top:-4.9013em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0556em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0556em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.3187em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">¨</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.0274em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">¨</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.3326em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"sARlwXk7Zu"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"=","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"wbl4qTVcj3"}],"key":"iJ1gjFLWly"},{"type":"math","value":"\\begin{bmatrix}\n\\omega_1 \\\\\n\\omega_2 \\\\\n-\\dfrac{d_2\\,\\ddot{\\theta}_2 + \\phi_1}{d_1} \\\\\n\\dfrac{\nu\n+ \\frac{d_2}{d_1}\\phi_1\n- m_2 l_1 l_{c2}\\,\\omega_1^2\\sin\\theta_2\n- \\phi_2\n}{\nm_2 l_{c2}^2 + I_2 - \\frac{d_2^2}{d_1}\n}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":40,"column":1},"end":{"line":51,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>ω</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>ω</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msub><mi>d</mi><mn>2</mn></msub><mtext> </mtext><msub><mover accent=\"true\"><mi>θ</mi><mo>¨</mo></mover><mn>2</mn></msub><mo>+</mo><msub><mi>ϕ</mi><mn>1</mn></msub></mrow><msub><mi>d</mi><mn>1</mn></msub></mfrac></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi>u</mi><mo>+</mo><mfrac><msub><mi>d</mi><mn>2</mn></msub><msub><mi>d</mi><mn>1</mn></msub></mfrac><msub><mi>ϕ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>m</mi><mn>2</mn></msub><msub><mi>l</mi><mn>1</mn></msub><msub><mi>l</mi><mrow><mi>c</mi><mn>2</mn></mrow></msub><mtext> </mtext><msubsup><mi>ω</mi><mn>1</mn><mn>2</mn></msubsup><mi>sin</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>−</mo><msub><mi>ϕ</mi><mn>2</mn></msub></mrow><mrow><msub><mi>m</mi><mn>2</mn></msub><msubsup><mi>l</mi><mrow><mi>c</mi><mn>2</mn></mrow><mn>2</mn></msubsup><mo>+</mo><msub><mi>I</mi><mn>2</mn></msub><mo>−</mo><mfrac><msubsup><mi>d</mi><mn>2</mn><mn>2</mn></msubsup><msub><mi>d</mi><mn>1</mn></msub></mfrac></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n\\omega_1 \\\\\n\\omega_2 \\\\\n-\\dfrac{d_2\\,\\ddot{\\theta}_2 + \\phi_1}{d_1} \\\\\n\\dfrac{\nu\n+ \\frac{d_2}{d_1}\\phi_1\n- m_2 l_1 l_{c2}\\,\\omega_1^2\\sin\\theta_2\n- \\phi_2\n}{\nm_2 l_{c2}^2 + I_2 - \\frac{d_2^2}{d_1}\n}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:8.0023em;vertical-align:-3.7512em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1501em;\"><span style=\"top:-3.211em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-4.358em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span style=\"height:4.2161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.2161em' style='width:0.6667em' viewBox='0 0 666.67 4216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V4216 H319z M319 0 H403 V4216 H319z'/></svg></span></span><span style=\"top:-9.2111em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2512em;\"><span style=\"top:-7.1425em;\"><span class=\"pstrut\" style=\"height:3.7313em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-5.9425em;\"><span class=\"pstrut\" style=\"height:3.7313em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.9742em;\"><span class=\"pstrut\" style=\"height:3.7313em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6083em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">¨</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-1.4069em;\"><span class=\"pstrut\" style=\"height:3.7313em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7313em;\"><span style=\"top:-2.11em;\"><span class=\"pstrut\" style=\"height:3.0916em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959em;\"><span style=\"top:-2.4337em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2663em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0916em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.5281em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8051em;\"><span style=\"top:-2.1885em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-2.8448em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3115em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.3216em;\"><span class=\"pstrut\" style=\"height:3.0916em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.9267em;\"><span class=\"pstrut\" style=\"height:3.0916em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8962em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4101em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4267em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7512em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.1501em;\"><span style=\"top:-3.211em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-4.358em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span style=\"height:4.2161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.2161em' style='width:0.6667em' viewBox='0 0 666.67 4216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V4216 H263z M263 0 H347 V4216 H263z'/></svg></span></span><span style=\"top:-9.2111em;\"><span class=\"pstrut\" style=\"height:6.2161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.6501em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"Ocvx8us8Us"},{"type":"math","value":"where","position":{"start":{"line":53,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">where</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">ere</span></span></span></span></span>","enumerator":"5","key":"bc7PTYWcao"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"d_1 =\nm_1 l_{c1}^2 +\nm_2\\left(l_1^2 + l_{c2}^2 + 2,l_1 l_{c2}\\cos \\theta_2\\right)","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"v4tczJdXn6"}],"key":"oNa9dNaoKG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":59,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":59,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"I_1 + I_2\n$$","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"AuVMMfgSh0"}],"key":"NZW0PQtKcw"}],"key":"HvVP8jBcgs"}],"key":"ys1uG6Vs7q"},{"type":"math","value":"d_2 =\nm_2\\left(l_{c2}^2 + l_1 l_{c2}\\cos\\theta_2\\right) + I_2","position":{"start":{"line":62,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub><mo>=</mo><msub><mi>m</mi><mn>2</mn></msub><mrow><mo fence=\"true\">(</mo><msubsup><mi>l</mi><mrow><mi>c</mi><mn>2</mn></mrow><mn>2</mn></msubsup><mo>+</mo><msub><mi>l</mi><mn>1</mn></msub><msub><mi>l</mi><mrow><mi>c</mi><mn>2</mn></mrow></msub><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub><mo fence=\"true\">)</mo></mrow><mo>+</mo><msub><mi>I</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">d_2 =\nm_2\\left(l_{c2}^2 + l_1 l_{c2}\\cos\\theta_2\\right) + I_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2141em;vertical-align:-0.35em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-2.453em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"6","key":"tkdtMbhjyH"},{"type":"math","value":"\\phi_2 =\nm_2 l_{c2} g \\cos(\\theta_1 + \\theta_2 - \\tfrac{\\pi}{2})","position":{"start":{"line":67,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>ϕ</mi><mn>2</mn></msub><mo>=</mo><msub><mi>m</mi><mn>2</mn></msub><msub><mi>l</mi><mrow><mi>c</mi><mn>2</mn></mrow></msub><mi>g</mi><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>−</mo><mstyle displaystyle=\"false\" scriptlevel=\"0\"><mfrac><mi>π</mi><mn>2</mn></mfrac></mstyle><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\phi_2 =\nm_2 l_{c2} g \\cos(\\theta_1 + \\theta_2 - \\tfrac{\\pi}{2})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.095em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"7","key":"qtGyd7n0th"},{"type":"math","value":"\\phi_1 =\n- m_2 l_1 l_{c2}\\,\\omega_2^2 \\sin\\theta_2\n- 2 m_2 l_1 l_{c2}\\,\\omega_1\\omega_2 \\sin\\theta_2\n+ (m_1 l_{c1} + m_2 l_1) g \\cos(\\theta_1 - \\tfrac{\\pi}{2})\n+ \\phi_2","position":{"start":{"line":72,"column":1},"end":{"line":78,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><msub><mi>m</mi><mn>2</mn></msub><msub><mi>l</mi><mn>1</mn></msub><msub><mi>l</mi><mrow><mi>c</mi><mn>2</mn></mrow></msub><mtext> </mtext><msubsup><mi>ω</mi><mn>2</mn><mn>2</mn></msubsup><mi>sin</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>−</mo><mn>2</mn><msub><mi>m</mi><mn>2</mn></msub><msub><mi>l</mi><mn>1</mn></msub><msub><mi>l</mi><mrow><mi>c</mi><mn>2</mn></mrow></msub><mtext> </mtext><msub><mi>ω</mi><mn>1</mn></msub><msub><mi>ω</mi><mn>2</mn></msub><mi>sin</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>+</mo><mo stretchy=\"false\">(</mo><msub><mi>m</mi><mn>1</mn></msub><msub><mi>l</mi><mrow><mi>c</mi><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>m</mi><mn>2</mn></msub><msub><mi>l</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mi>g</mi><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>−</mo><mstyle displaystyle=\"false\" scriptlevel=\"0\"><mfrac><mi>π</mi><mn>2</mn></mfrac></mstyle><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>ϕ</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\phi_1 =\n- m_2 l_1 l_{c2}\\,\\omega_2^2 \\sin\\theta_2\n- 2 m_2 l_1 l_{c2}\\,\\omega_1\\omega_2 \\sin\\theta_2\n+ (m_1 l_{c1} + m_2 l_1) g \\cos(\\theta_1 - \\tfrac{\\pi}{2})\n+ \\phi_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1111em;vertical-align:-0.247em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.095em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϕ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"8","key":"J9UgYmks0V"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"The system can be implement as follows","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"GAjz4By3QK"}],"key":"Xzp517s2Rp"}],"identifier":"755ca7e0","label":"755ca7e0","html_id":"id-755ca7e0","key":"E9wyiNnMeH"},{"type":"block","kind":"notebook-code","data":{"id":"5c4e460e"},"children":[{"type":"code","lang":"python","executable":true,"value":"# Example default parameters (you can adjust)\ndefault_params = dict(\n    m1=1.0, m2=1.0,\n    l1=1.0, l2=1.0,\n    lc1=0.5, lc2=0.5,\n    I1=1.0, I2=1.0,\n    g=9.81\n)\n\ndef acrobot_dynamics(t, x, u, params):\n    \"\"\"\n    Continuous-time Acrobot dynamics:\n        x = [theta1, theta2, theta1_dot, theta2_dot]\n        u = torque at joint 2 (scalar)\n    Returns xdot.\n    \"\"\"\n    # Unpack state\n    th1, th2, omega1, omega2 = x\n\n    # Unpack parameters\n    m1, m2, l1, lc1, lc2, I1, I2, g = (params.get(key) for key in ['m1', 'm2', 'l1', 'lc1', 'lc2', 'I1', 'I2', 'g'])\n\n    # Compute intermediate terms\n    d1 = (m1 * lc1**2 +\n          m2 * (l1**2 + lc2**2 + 2 * l1 * lc2 * np.cos(th2)) +\n          I1 + I2)\n\n    d2 = m2 * (lc2**2 + l1 * lc2 * np.cos(th2)) + I2\n\n    phi2 = m2 * lc2 * g * np.cos(th1 + th2 - np.pi/2)\n\n    phi1 = (-m2 * l1 * lc2 * omega2**2 * np.sin(th2)\n            - 2 * m2 * l1 * lc2 * omega1 * omega2 * np.sin(th2)\n            + (m1 * lc1 + m2 * l1) * g * np.cos(th1 - np.pi/2)\n            + phi2)\n\n    # Compute angular accelerations\n    # From the coupled equations, solve for th2_dd first, then th1_dd\n    denominator = m2 * lc2**2 + I2 - d2**2 / d1\n    th2_dd = (u + (d2 / d1) * phi1\n              - m2 * l1 * lc2 * omega1**2 * np.sin(th2)\n              - phi2) / denominator\n\n    th1_dd = -(d2 * th2_dd + phi1) / d1\n\n    # Return state derivative\n    return np.array([omega1, omega2, th1_dd, th2_dd])","identifier":"5c4e460e-code","enumerator":"2","html_id":"id-5c4e460e-code","key":"S1H1k0JrDz"},{"type":"outputs","id":"4eqnz3LFLum8hK5_w7FUR","children":[],"identifier":"5c4e460e-outputs","html_id":"id-5c4e460e-outputs","key":"yEf5qQggvf"}],"identifier":"5c4e460e","label":"5c4e460e","html_id":"id-5c4e460e","key":"bmCcwSA2nx"},{"type":"block","kind":"notebook-content","data":{"id":"9dab89d9"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can test the dynamics model by simulating it","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Luh4bONw3w"}],"key":"k3xPYjVQTE"}],"key":"IHzzWX3z4G"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Choose an initial condition, e.g., both links hanging downward with small perturbation.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ypOuw6RpyA"}],"key":"UKjihC6Hm1"}],"key":"yDdVgMqmAA"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Simulate the passive dynamics (","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"X3kKaxpooG"},{"type":"inlineCode","value":"u = 0","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WD7sPNuD5v"},{"type":"text","value":") for a few seconds.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lyk6PCkegS"}],"key":"Ulp9UsS46V"}],"key":"uuSejh1IWd"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plot ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tjPayFvJ9X"},{"type":"inlineMath","value":"\\theta_1(t)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\theta_1(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"HYWO7FAD9D"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IypLfDODL0"},{"type":"inlineMath","value":"\\theta_2(t)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\theta_2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"hNIS4eVvPz"},{"type":"text","value":" to verify qualitatively that the dynamics look reasonable.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ehixQKoGQY"}],"key":"qv1vjqOUo4"}],"key":"JvR11gwLeU"}],"key":"uOCYOs5GHG"}],"identifier":"9dab89d9","label":"9dab89d9","html_id":"id-9dab89d9","key":"QKeDdDaqUx"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/","height":477},"executionInfo":{"elapsed":334,"status":"ok","timestamp":1765082675386,"user":{"displayName":"Jianguo Zhao","userId":"09996222056778326224"},"user_tz":420},"id":"12a19ed6","outputId":"e6647bae-23a1-4e99-c9c1-45bdb6c84b05"},"children":[{"type":"code","lang":"python","executable":true,"value":"def simulate_acrobot(x0, u_fun, T=5.0, params=default_params):\n    \"\"\"\n    Simulate Acrobot with given input function u_fun(t, x).\n    \"\"\"\n    def fwrap(t, x):\n        u = u_fun(t, x)\n        return acrobot_dynamics(t, x, u, params)\n\n    sol = solve_ivp(fwrap, [0, T], x0, max_step=0.01, rtol=1e-6, atol=1e-8)\n    return sol.t, sol.y\n\n# Example usage (uncomment after implementing dynamics):\nx0 = np.array([0.3, 0.4, 0.0, 0.0])\nt, X = simulate_acrobot(x0, lambda t, x: 0.0) # lambda t, x: 0.0 means u=0\nplt.figure()\nplt.plot(t, X[0], label=\"theta1\")\nplt.plot(t, X[2], label=\"theta2\")\nplt.legend()\nplt.xlabel(\"Time [s]\")\nplt.ylabel(\"Angle [rad]\")\nplt.title(\"Passive Acrobot Dynamics (u=0)\")\nplt.show()","identifier":"12a19ed6-code","enumerator":"3","html_id":"id-12a19ed6-code","key":"pR5UCvCEMv"},{"type":"outputs","id":"3mukllI2pgom2A4P3cnVJ","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bdd1da09fb2aa8701d5caa42abd75c0c","path":"/bdd1da09fb2aa8701d5caa42abd75c0c.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"identifier":"12a19ed6-outputs-0","html_id":"id-12a19ed6-outputs-0","key":"OkV6daeHmx"}],"identifier":"12a19ed6-outputs","html_id":"id-12a19ed6-outputs","key":"eEaAVSSlmR"}],"identifier":"12a19ed6","label":"12a19ed6","html_id":"id-12a19ed6","key":"wxCFJunRyq"},{"type":"block","kind":"notebook-content","data":{"id":"65d0d8ea"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can also create animation to show the motion for the system.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EjNkU4CC57"}],"key":"I3YzENzyix"}],"identifier":"65d0d8ea","label":"65d0d8ea","html_id":"id-65d0d8ea","key":"Ux8dO5ikeN"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"output_embedded_package_id":"18SjKre2KvA9UJFJbY_a9WlcBkZD9mdJS"},"executionInfo":{"elapsed":98069,"status":"ok","timestamp":1765082777312,"user":{"displayName":"Jianguo Zhao","userId":"09996222056778326224"},"user_tz":420},"id":"a851396f","outputId":"87bfccdb-0ce8-49c9-d4ed-d695612f4e12"},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib.animation import FuncAnimation\nfrom IPython.display import HTML, display\n\ndef animate_acrobot_solution(sol, x0, params=None, duration=5.0):\n    \"\"\"\n    Create animation from a solved acrobot ODE solution.\n\n    Parameters:\n    sol: Solution object containing time array t and state array y\n    x0: Initial state [theta1, theta2, omega1, omega2]\n    params: Dictionary of acrobot parameters (uses default_params if None)\n    duration: Animation duration (s)\n\n    Returns:\n    HTML animation object\n    \"\"\"\n    if params is None:\n        params = default_params\n\n    l1 = params['l1']\n    l2 = params['l2']\n\n    # Set up the figure and axis for animation\n    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))\n\n    # Acrobot animation subplot\n    total_length = l1 + l2\n    ax1.set_xlim(-total_length * 1.2, total_length * 1.2)\n    ax1.set_ylim(-total_length * 1.2, total_length * 1.2)\n    ax1.set_aspect('equal')\n    ax1.set_title(f'Acrobot Animation (θ₁₀={x0[0]:.2f}, θ₂₀={x0[1]:.2f})')\n    ax1.grid(True)\n    ax1.plot(0, 0, 'ko', markersize=8)  # Fixed pivot point\n\n    # Create acrobot elements\n    link1, = ax1.plot([], [], 'b-', linewidth=4, label='Link 1')\n    link2, = ax1.plot([], [], 'r-', linewidth=4, label='Link 2')\n    joint1, = ax1.plot([], [], 'ko', markersize=8)\n    joint2, = ax1.plot([], [], 'go', markersize=10)\n    trace, = ax1.plot([], [], 'g--', alpha=0.3, linewidth=1)\n    ax1.legend()\n\n    # Time series subplot\n    ax2.set_xlim(0, duration)\n    ax2.set_ylim(-np.pi, np.pi)\n    ax2.set_xlabel('Time (s)')\n    ax2.set_ylabel('Angle (rad)')\n    ax2.set_title('Joint Angles vs Time')\n    ax2.grid(True)\n\n    theta1_line, = ax2.plot([], [], 'b-', label='θ₁(t)', linewidth=2)\n    theta2_line, = ax2.plot([], [], 'r-', label='θ₂(t)', linewidth=2)\n    time_marker1, = ax2.plot([], [], 'bo', markersize=6)\n    time_marker2, = ax2.plot([], [], 'ro', markersize=6)\n    ax2.legend()\n\n    # Store trace points\n    x_trace, y_trace = [], []\n\n    # Animation function\n    def animate(frame):\n        if frame < len(sol.t):\n            # Current state\n            theta1 = sol.y[0][frame]\n            theta2 = sol.y[1][frame]\n            t_current = sol.t[frame]\n\n            # Joint positions\n            x1 = l1 * np.sin(theta1)\n            y1 = -l1 * np.cos(theta1)\n            x2 = x1 + l2 * np.sin(theta1 + theta2)\n            y2 = y1 - l2 * np.cos(theta1 + theta2)\n\n            # Update acrobot links\n            link1.set_data([0, x1], [0, y1])\n            link2.set_data([x1, x2], [y1, y2])\n            joint1.set_data([x1], [y1])\n            joint2.set_data([x2], [y2])\n\n            # Update trace (last 100 points)\n            x_trace.append(x2)\n            y_trace.append(y2)\n            if len(x_trace) > 100:\n                x_trace.pop(0)\n                y_trace.pop(0)\n            trace.set_data(x_trace, y_trace)\n\n            # Update time series\n            theta1_line.set_data(sol.t[:frame+1], sol.y[0][:frame+1])\n            theta2_line.set_data(sol.t[:frame+1], sol.y[1][:frame+1])\n            time_marker1.set_data([t_current], [theta1])\n            time_marker2.set_data([t_current], [theta2])\n\n        return link1, link2, joint1, joint2, trace, theta1_line, theta2_line, time_marker1, time_marker2\n\n    # Create and display animation\n    anim = FuncAnimation(fig, animate, frames=len(sol.t), interval=50, blit=True, repeat=True)\n    plt.tight_layout()\n    plt.show()\n\n    # Return HTML version for display\n    return HTML(anim.to_jshtml())\n\n# Create solution object from existing variables\nfrom types import SimpleNamespace\nsolution = SimpleNamespace(t=t, y=X)\n\nprint(f\"Animating acrobot with initial state: θ₁={x0[0]:.2f}, θ₂={x0[1]:.2f}, ω₁={x0[2]:.2f}, ω₂={x0[3]:.2f}\")\nprint(f\"Solution contains {len(solution.t)} time points over {solution.t[-1]:.2f} seconds\")\n\n# Create and display animation\nprint(\"Creating animation...\")\nanimation_html = animate_acrobot_solution(solution, x0, default_params, duration=t[-1])\ndisplay(animation_html)","identifier":"a851396f-code","enumerator":"4","html_id":"a851396f-code","key":"K5tWmaLfnY"},{"type":"outputs","id":"1H8YdA7hnRbgRBCl76qVk","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"Output hidden; open in https://colab.research.google.com to view.","content_type":"text/plain"}}},"children":[],"identifier":"a851396f-outputs-0","html_id":"a851396f-outputs-0","key":"r44itr8VMf"}],"identifier":"a851396f-outputs","html_id":"a851396f-outputs","key":"XSJ5vEmtkB"}],"identifier":"a851396f","label":"a851396f","html_id":"a851396f","key":"KAH9hSI752"},{"type":"block","kind":"notebook-content","data":{"id":"b706402f"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 2. Linearization and LQR Design (20 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xTbIezxWns"}],"identifier":"task-2-linearization-and-lqr-design-20-pts","label":"Task 2. Linearization and LQR Design (20 pts)","html_id":"task-2-linearization-and-lqr-design-20-pts","implicit":true,"key":"mWs28SpIoi"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"With the dynamics model, we can design controllers for the Acrobot. In this task, you need to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fQw08Taj0I"}],"key":"lTZY2PKgw4"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Choose an equilibrium point for the system to stabilize (e.g., the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Q0jDV2DZka"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"upright configuration","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QWpGioTXT3"}],"key":"c6uteBDZgl"},{"type":"text","value":").","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xAWtXsrEys"}],"key":"fRImNIebfU"}],"key":"TAeSTyonty"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Linearize the dynamics about that equilibrium to obtain:  ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"MsWYGwEman"},{"type":"inlineMath","value":"\\dot{x} = A x + B u ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>˙</mo></mover><mo>=</mo><mi>A</mi><mi>x</mi><mo>+</mo><mi>B</mi><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">\\dot{x} = A x + B u </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6679em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"jrk5NsQBwN"}],"key":"kXtrZ5VUgi"}],"key":"LwbWA2Bfvv"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Design an ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"T9wAmuV4FT"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"LQR controller","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Jq9kuorQOv"}],"key":"PJCuszZqLk"},{"type":"text","value":": ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"iycF2dk6gf"},{"type":"inlineMath","value":"   u = -Kx ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>=</mo><mo>−</mo><mi>K</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">   u = -Kx </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"UDlkcuytLi"}],"key":"AMKLDSBsoz"}],"key":"bwGTyYwzeQ"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Simulate the closed-loop system and analyze performance (settling time, energy, etc.).","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"fzAY5FFpsg"}],"key":"kCPPmsLrXp"}],"key":"StbcfztbMw"}],"key":"Tu3nWuF3TS"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Task 2.1 – Equilibrium Point (5 pts)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kPcKmJif0s"}],"identifier":"task-2-1-equilibrium-point-5-pts","label":"Task 2.1 – Equilibrium Point (5 pts)","html_id":"task-2-1-equilibrium-point-5-pts","implicit":true,"key":"E2rkmb60GE"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"For the Acrobot system, one important equilibrium point is the ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"NQ50eFLvEm"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"upright configuration","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"oyTpReWzEv"}],"key":"kXXoLpG8Hq"},{"type":"text","value":":","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"taRD3lqiNl"}],"key":"fpZYane0lc"},{"type":"math","value":"x_{eq} = [\\pi, 0, 0, 0]^T","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>x</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub><mo>=</mo><mo stretchy=\"false\">[</mo><mi>π</mi><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">x_{eq} = [\\pi, 0, 0, 0]^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"9","key":"BZjnj9Gllx"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"This corresponds to:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"GhqMgxXvrt"}],"key":"rL0flyWKpd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\theta_1 = \\pi","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub><mo>=</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\theta_1 = \\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"YIXsRgaPRj"},{"type":"text","value":" (first link pointing upward)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"OcYh1HvqDO"}],"key":"pFw48cC8DW"}],"key":"oPoHB4uUEB"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\theta_2 = 0","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\theta_2 = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"OUFZhCqQT4"},{"type":"text","value":" (second link aligned with first link)","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"DmhMInDXT0"}],"key":"ZetzNve1wQ"}],"key":"qshkAZSfX6"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dot{\\theta}_1 = 0","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>θ</mi><mo>˙</mo></mover><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\dot{\\theta}_1 = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0813em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0556em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"T1Pbr7eHkm"},{"type":"text","value":" (no angular velocity)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"stwrLqQmk5"}],"key":"bSWGH4b9oZ"}],"key":"zad2gv7Pxf"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dot{\\theta}_2 = 0","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\dot{\\theta}_2 = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0813em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0556em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"W0Rof87ltb"},{"type":"text","value":" (no angular velocity)","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"zw34FEPrOL"}],"key":"dM8Uk9Hgcn"}],"key":"ii77jjOeOr"}],"key":"Nr5JXTZb1b"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Answer the following questions","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Rcu4gUP04K"}],"key":"jtMlBAimMB"},{"type":"text","value":" in your project report:","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"XzXTkwJPfy"}],"key":"aIKWM4Darc"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Verification","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"i51Pcy4QWe"}],"key":"FuCMz46tyV"},{"type":"text","value":": Show that ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"XSTPNXNriY"},{"type":"inlineMath","value":"x_{eq} = [\\pi, 0, 0, 0]^T","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub><mo>=</mo><mo stretchy=\"false\">[</mo><mi>π</mi><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">x_{eq} = [\\pi, 0, 0, 0]^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"JqyyOhdOyY"},{"type":"text","value":" is indeed an equilibrium point by verifying that ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"vzcwn7uwzD"},{"type":"inlineMath","value":"\\dot{x} = 0","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>˙</mo></mover><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\dot{x} = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6679em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"DY5ioTNcpP"},{"type":"text","value":" when ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"HlrenZznec"},{"type":"inlineMath","value":"x = x_{eq}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><msub><mi>x</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x = x_{eq}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zdNMW3TjZX"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"gonlEGx5ap"}],"key":"ojpOvcT4Fq"}],"key":"iP2V7zb8s7"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Equilibrium Input","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"i07HWbk9To"}],"key":"MnoWGAPAtK"},{"type":"text","value":": Calculate the corresponding equilibrium control input ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"CHmMdpsAQA"},{"type":"inlineMath","value":"u_{eq}","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">u_{eq}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"STZUkilBrZ"},{"type":"text","value":" (torque at joint 2) required to maintain this upright configuration.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"R94UwJWWwa"}],"key":"OlgtojmT6M"}],"key":"FrKIuJnTds"}],"key":"mEJY0WVbOL"}],"identifier":"b706402f","label":"b706402f","html_id":"b706402f","key":"mPt881xeOk"},{"type":"block","kind":"notebook-content","data":{"id":"a6766242"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 2.2 – Linearization around the equilibrium point (5 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QckTbJcHQk"}],"identifier":"task-2-2-linearization-around-the-equilibrium-point-5-pts","label":"Task 2.2 – Linearization around the equilibrium point (5 pts)","html_id":"task-2-2-linearization-around-the-equilibrium-point-5-pts","implicit":true,"key":"jdSbCgkfCU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wgrv2ZfuDH"},{"type":"inlineCode","value":"Python Control","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u3M7bfcKA2"},{"type":"text","value":" library to linearize the system around ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RzHtwhDgo4"},{"type":"inlineMath","value":"x_{eq}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_{eq}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XhdFIgvxiP"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZIkSUjj82G"},{"type":"inlineMath","value":"u_{eq}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">u_{eq}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"J7Y5kkqmho"},{"type":"text","value":". First create the nonlinear system object using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fK1v2C4Hf4"},{"type":"inlineCode","value":"ctl.nlsys","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i3OegV5ces"},{"type":"text","value":" in the python control library, then use ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lnOr79CtDK"},{"type":"inlineCode","value":"linearize","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QrdKU6DmFI"},{"type":"text","value":" to linearize the system.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HSr4LprHbn"}],"key":"tc6zlycaER"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the code below, you need to:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DdCmXmBJG9"}],"key":"vHywzul9u8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Complete the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PEpZiVKnx0"},{"type":"inlineCode","value":"acrobot_update","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BxmR5CIvHi"},{"type":"text","value":" function by calling ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QWHiVE2P9Q"},{"type":"inlineCode","value":"acrobot_dynamics","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"L8sGVrHUmq"},{"type":"text","value":" with the correct inputs (note that ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kVllR43sWT"},{"type":"inlineCode","value":"u","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"m82CQOhV1n"},{"type":"text","value":" will be a 1-element array)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"teD9gRUb6a"}],"key":"eVXmHQ7uY1"}],"key":"x06kGt2rbn"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Complete the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rN6Mrkn4it"},{"type":"inlineCode","value":"acrobot_output","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"v1Q6MgLILZ"},{"type":"text","value":" function to return the full state vector as output","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Bhe1EfCScQ"}],"key":"CL68bLjxub"}],"key":"idLEzMvgBI"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The linearization will then be performed automatically around the specified equilibrium point","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rR1Yx5hUFn"}],"key":"BRKUvoUUau"}],"key":"DnMcwxzGJv"}],"key":"j0fS68hSNM"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"After linearization, you will obtain the linear system matrices ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"coqmXbtsJb"},{"type":"inlineMath","value":"A","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"JOIKrpXWV1"},{"type":"text","value":" and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zkZluJAY95"},{"type":"inlineMath","value":"B","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>","key":"Qx5Ng9VmKA"},{"type":"text","value":" such that:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Bq0RyoO22i"}],"key":"mzsjxkskcH"},{"type":"math","value":"\\dot{x} = A(x - x_{eq}) + B(u - u_{eq})","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>˙</mo></mover><mo>=</mo><mi>A</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>B</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo>−</mo><msub><mi>u</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\dot{x} = A(x - x_{eq}) + B(u - u_{eq})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6679em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"10","key":"Cf367hQkV4"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Print out the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"AzZos6ImNo"},{"type":"inlineMath","value":"A","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"Lk8wpGuOok"},{"type":"text","value":" and ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"DuDoIcCd18"},{"type":"inlineMath","value":"B","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>","key":"onBrXXlJ2v"},{"type":"text","value":" matrices for the linearized system and put this into your project report.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"j2jKrmNwNs"}],"key":"G3lQ9gpDau"}],"identifier":"a6766242","label":"a6766242","html_id":"a6766242","key":"EQTeqq2jjI"},{"type":"block","kind":"notebook-code","data":{"id":"df4044d4"},"children":[{"type":"code","lang":"python","executable":true,"value":"# Use the default parameters defined earlier for the Acrobot model\nacrobot_params = default_params\n\n# State derivative function for python-control\ndef acrobot_update(t, x, u, params):\n    \"\"\"\n    Wrapper for the acrobot_dynamics function to be used with control.nlsys.\n    The input 'u' from nlsys is an array, so we extract the scalar torque.\n    \"\"\"\n    # TODO: Call the acrobot_dynamics function with the correct inputs.\n\n# Output function for python-control\ndef acrobot_output(t, x, u, params):\n    \"\"\"\n    Defines the system output. For state-feedback control, we assume we have the full state as the output.\n    \"\"\"\n    # TODO: Return the state vector as the output.\n\n\n# Create the nonlinear system object using nlsys\nacrobot_nlsys = ctl.nlsys(\n    acrobot_update,\n    acrobot_output,\n    name='acrobot',\n    params=acrobot_params,\n    states=['theta1', 'theta2', 'omega1', 'omega2'],\n    outputs=['theta1', 'theta2', 'omega1', 'omega2'],\n    inputs=['tau']\n)\n\n# After filling in the TODOs, linearize the system using acrobot_nlsys.linearize\n# TODO: linearize the system at the upright equilibrium point","identifier":"df4044d4-code","enumerator":"5","html_id":"df4044d4-code","key":"DDU8Fdd4uI"},{"type":"outputs","id":"F2HuPFYt-tNRPwj0aFg7N","children":[],"identifier":"df4044d4-outputs","html_id":"df4044d4-outputs","key":"tqcPYm8UbI"}],"identifier":"df4044d4","label":"df4044d4","html_id":"df4044d4","key":"HTEokT2OiB"},{"type":"block","kind":"notebook-content","data":{"id":"720085b1"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 2.3 – LQR Controller Design for the Linearized System (10 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bLhPTisyJB"}],"identifier":"task-2-3-lqr-controller-design-for-the-linearized-system-10-pts","label":"Task 2.3 – LQR Controller Design for the Linearized System (10 pts)","html_id":"task-2-3-lqr-controller-design-for-the-linearized-system-10-pts","implicit":true,"key":"mUVtg8aMBB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this task, you will design an LQR controller to stabilize the Acrobot around the upright configuration by completing the following steps:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xQgxoYjWOj"}],"key":"WgWpTHc8Q8"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Step 1: Check System Controllability","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BIt38asNjG"}],"key":"y4R0NwW7Jz"}],"key":"t31vooLDPt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute the controllability matrix using ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VyH5y6iWp1"},{"type":"inlineCode","value":"ctl.ctrb(A, B)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"upiGexQBsi"}],"key":"UBmJzmQiGt"}],"key":"iq9oaY1Qsh"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Check if the system is controllable by verifying that the rank equals the number of states (4)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ygC8JgAvSM"}],"key":"L2dMLVoW3h"}],"key":"TSbXp38nxK"}],"key":"KEeCthKbJB"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Step 2: Design LQR Controller","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Ax2sD3Upz2"}],"key":"ElW2nigyfL"}],"key":"CkKqD6fxLa"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Choose appropriate LQR weight matrices ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Sps8rPXDNm"},{"type":"inlineMath","value":"Q_x","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KFSIcsPG6f"},{"type":"text","value":" (4×4) and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"QnZumNTvoJ"},{"type":"inlineMath","value":"Q_u","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>u</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Q0c8ZNK0eS"},{"type":"text","value":" (1×1)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"F4QgiF7SI4"}],"key":"qengFHWuGe"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"Q_x","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lqyxLAslWb"},{"type":"text","value":" penalizes state deviations from equilibrium","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"T6rZ6Zl0qP"}],"key":"oJPegIKd2w"}],"key":"BNbGSen4cA"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"Q_u","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>u</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"CkARe3zFr6"},{"type":"text","value":" penalizes control effort","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"bqPtOEWVis"}],"key":"TwYlh8CFID"}],"key":"kgJCpJky2Q"}],"key":"EKZEwusRuW"}],"key":"Y6S7IoKq6D"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Ef2pv5kZIH"},{"type":"inlineCode","value":"ctl.lqr(A, B, Qx, Qu)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"bafYag56mK"},{"type":"text","value":" to compute the feedback gain matrix ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uIpgWDW7zV"},{"type":"inlineMath","value":"K","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>","key":"OVR9MQOu5m"}],"key":"noV2CD2vOW"}],"key":"wmjwKnX5k8"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The resulting controller will be: ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"rxG8j07Tbr"},{"type":"inlineMath","value":"u = -K (x - x_{\\text{eq}}) + u_{\\text{eq}}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>=</mo><mo>−</mo><mi>K</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mtext>eq</mtext></msub><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>u</mi><mtext>eq</mtext></msub></mrow><annotation encoding=\"application/x-tex\">u = -K (x - x_{\\text{eq}}) + u_{\\text{eq}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">eq</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">eq</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"UqCmKI5rrs"}],"key":"ohxeiJh9ns"}],"key":"pd9eGjtZAP"}],"key":"TimfY2GcY1"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Step 3: Simulate Closed-Loop System","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"m4ElVPepUT"}],"key":"hGZFi35Ext"},{"type":"text","value":"\nTest your LQR controller with two initial conditions near the upright equilibrium:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"iKlqZ1YC4c"}],"key":"X6hvSItSD6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"x_0 = [19\\pi/20, \\pi/10, 0, 0]^T","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mo stretchy=\"false\">[</mo><mn>19</mn><mi>π</mi><mi mathvariant=\"normal\">/</mi><mn>20</mn><mo separator=\"true\">,</mo><mi>π</mi><mi mathvariant=\"normal\">/</mi><mn>10</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">x_0 = [19\\pi/20, \\pi/10, 0, 0]^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">19</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord\">/20</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord\">/10</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"n0WdQqntqF"}],"key":"sA6PMjUfJ8"}],"key":"XYzFNOyTf7"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"x_0 = [9\\pi/10, \\pi/5, 0, 0]^T","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mo stretchy=\"false\">[</mo><mn>9</mn><mi>π</mi><mi mathvariant=\"normal\">/</mi><mn>10</mn><mo separator=\"true\">,</mo><mi>π</mi><mi mathvariant=\"normal\">/</mi><mn>5</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">x_0 = [9\\pi/10, \\pi/5, 0, 0]^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">9</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord\">/10</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord\">/5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"LcriTz1hsi"}],"key":"Moq03cwqsa"}],"key":"TWpFSCpxa2"}],"key":"CmnmEL0GHj"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"For each initial condition, create plots showing:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"UTIxeaD5n6"}],"key":"i0NH4hRszg"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"All four state trajectories vs time: ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"yG8qUxUu4u"},{"type":"inlineMath","value":"\\theta_1(t)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\theta_1(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"Px8INyvf2X"},{"type":"text","value":", ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"h7JcBsg15G"},{"type":"inlineMath","value":"\\theta_2(t)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\theta_2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"eKTfF2j9Hf"},{"type":"text","value":", ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"vGbc9GqpdT"},{"type":"inlineMath","value":"\\dot{\\theta}_1(t)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>θ</mi><mo>˙</mo></mover><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\dot{\\theta}_1(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1813em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0556em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"cjno3mE5YJ"},{"type":"text","value":", ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"a83bNoAOUi"},{"type":"inlineMath","value":"\\dot{\\theta}_2(t)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\dot{\\theta}_2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1813em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0556em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"WwVNtgE8Bw"}],"key":"y6OJXecWD7"}],"key":"SZnChYD4At"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Control input vs time: ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"fR2o4UhAiA"},{"type":"inlineMath","value":"u(t)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"hUjpYBw1Yi"}],"key":"NJ6Ty2iTDn"}],"key":"Y7iU65QXfo"}],"key":"arjTIVMx7x"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Step 4: Performance Evaluation","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"iq0uhv7b5J"}],"key":"N2HdeL3js8"},{"type":"text","value":"\nAnalyze your results by addressing:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Qx3cJKqG5U"}],"key":"SpWeAnxBGi"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Does the controller successfully stabilize both initial conditions?","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"wqdkVCekcg"}],"key":"QQ5A0O7345"}],"key":"ldnoagvc22"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"What is the approximate settling time for each state?","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"S5fi9agpzZ"}],"key":"rhIFYOQTcR"}],"key":"icZqiMVZLF"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How does changing the weight matrices ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"HArCjK8cuC"},{"type":"inlineMath","value":"Q_x","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WjIyRBfxhg"},{"type":"text","value":" and ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"r7xwCYqQ3p"},{"type":"inlineMath","value":"Q_u","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>u</mi></msub></mrow><annotation encoding=\"application/x-tex\">Q_u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IxGOni1aQz"},{"type":"text","value":" affect performance? Try at least two different weight combinations and compare the results","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"eHp7ZSvpvo"}],"key":"aDpFSIkAeO"}],"key":"tHTa6sH3iv"}],"key":"KYZv8RIR2J"}],"identifier":"720085b1","label":"720085b1","html_id":"id-720085b1","key":"lSq1NLtseE"},{"type":"block","kind":"notebook-code","data":{"id":"5fed28e3"},"children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: choose equilibrium and design LQR\n","identifier":"5fed28e3-code","enumerator":"6","html_id":"id-5fed28e3-code","key":"RYyBpmETiG"},{"type":"outputs","id":"s4LflDxxZvrrFu3M62wpP","children":[],"identifier":"5fed28e3-outputs","html_id":"id-5fed28e3-outputs","key":"MK3n9hBci0"}],"identifier":"5fed28e3","label":"5fed28e3","html_id":"id-5fed28e3","key":"HXK6wGtIFz"},{"type":"block","kind":"notebook-content","data":{"id":"21473867"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 3. Trajectory Generation and Tracking (30 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pi2U1mnNpG"}],"identifier":"task-3-trajectory-generation-and-tracking-30-pts","label":"Task 3. Trajectory Generation and Tracking (30 pts)","html_id":"task-3-trajectory-generation-and-tracking-30-pts","implicit":true,"key":"evJPAtj6t7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Task 2 only stabilizes the Acrobot around the upright configuration. But what if the Acrobot is initially pointing downward? In this task, you will design controllers to swing the Acrobot up from the downward position to the upright position. Specifically, you will:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dFgAq7tT2o"}],"key":"GSVBrsr2u9"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Define a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"x5Wejg9at9"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"swing-up task","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ILfFkivsCP"}],"key":"FfX2VFPHgY"},{"type":"text","value":" for the Acrobot (e.g., from downward configuration to upright).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rPFsPPjf6D"}],"key":"Q9M5NUCYPm"}],"key":"DlCti9czQo"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Generate an optimal trajectory from downward configuration to upright (refer to Lab 7).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"RyQvAmYh7T"}],"key":"nh6xQKLupw"}],"key":"dOA4lw2HvF"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Design an MPC controller to track the generated optimal trajectory (refer to Lab 8)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NZkzaYnp7E"}],"key":"Id9fZvEfo0"}],"key":"hWbYPHc3VN"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Simulate the resulting ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lDn3GwMSnP"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"trajectory tracking control","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"fcScFRpgUO"}],"key":"otEftO0DuL"},{"type":"text","value":" on the nonlinear system.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"FaNjY58iR3"}],"key":"vwT4K4p44f"}],"key":"Bs29mebsho"}],"key":"TnviGh3wYf"}],"identifier":"21473867","label":"21473867","html_id":"id-21473867","key":"pTYFVjCYly"},{"type":"block","kind":"notebook-content","data":{"id":"f9103b60"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 3.1 – Optimal Trajectory Generation (10 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ogkz4bxpBZ"}],"identifier":"task-3-1-optimal-trajectory-generation-10-pts","label":"Task 3.1 – Optimal Trajectory Generation (10 pts)","html_id":"task-3-1-optimal-trajectory-generation-10-pts","implicit":true,"key":"MkFzi3OdyB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Generate and plot the optimal trajectory using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"w9xybm3lOv"},{"type":"inlineCode","value":"solve_ocp","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Nc6MkzIY8y"},{"type":"text","value":" for the followint case","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qf1OViiqYg"}],"key":"jh7pmYxgw9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Input cost with terminal constraint:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"s5884wHjI0"}],"key":"TrIPzBoOuY"},{"type":"text","value":"\n","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Zku8D3GPYw"}],"key":"fx4LhG86Q4"},{"type":"math","value":"\\min_{u(\\cdot)} \\int_0^T (u(\\tau) - u_f)^T Q_u (u(\\tau) - u_f)\\, d\\tau","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mo>⋅</mo><mo stretchy=\"false\">)</mo></mrow></munder><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">(</mo><mi>τ</mi><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>u</mi><mi>f</mi></msub><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><msub><mi>Q</mi><mi>u</mi></msub><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">(</mo><mi>τ</mi><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>u</mi><mi>f</mi></msub><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>d</mi><mi>τ</mi></mrow><annotation encoding=\"application/x-tex\">\\min_{u(\\cdot)} \\int_0^T (u(\\tau) - u_f)^T Q_u (u(\\tau) - u_f)\\, d\\tau</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.5572em;vertical-align:-0.966em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.309em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">⋅</span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.966em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5912em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1774em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span></span></span></span></span>","enumerator":"11","key":"a69gMW8dpL"},{"type":"paragraph","children":[{"type":"text","value":"\nsubject to ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lXSHc50PUy"},{"type":"inlineMath","value":"x(T) = x_f","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>x</mi><mi>f</mi></msub></mrow><annotation encoding=\"application/x-tex\">x(T) = x_f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"c0fu3BxXIH"},{"type":"text","value":"\nAlso consider the constraint on the control input ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"N5U7de73co"},{"type":"inlineMath","value":"|u| \\leq 5","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>u</mi><mi mathvariant=\"normal\">∣</mi><mo>≤</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">|u| \\leq 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">u</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"DGlQdRiOfI"},{"type":"text","value":" Nm.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VMHLjQooAk"}],"key":"k1EudwoN43"}],"key":"EhIMHsLBoR"}],"key":"yrsmpUvDxq"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"After generating the optimal trajectory, you need to ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"w0ASs28f1B"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"simluate the system","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"GKnK8gzsKt"}],"key":"HGACyG5npF"},{"type":"text","value":" using the optimal control inputs and make sure that the system will behave accordingly, i.e., it will actually swing up.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ROctJ3Jg9a"}],"key":"d4jy7h7PQD"}],"identifier":"f9103b60","label":"f9103b60","html_id":"f9103b60","key":"Rn3AP439Ih"},{"type":"block","kind":"notebook-code","data":{"id":"30edf78c"},"children":[{"type":"code","lang":"python","executable":true,"value":"# TODO: write your code here for the optimal trajecotry generation","identifier":"30edf78c-code","enumerator":"7","html_id":"id-30edf78c-code","key":"PkLyITM5u4"},{"type":"outputs","id":"R5-H1kdwxz0ooE32U2m-X","children":[],"identifier":"30edf78c-outputs","html_id":"id-30edf78c-outputs","key":"HANTgkDKKv"}],"identifier":"30edf78c","label":"30edf78c","html_id":"id-30edf78c","key":"LlLsyxdWlA"},{"type":"block","kind":"notebook-content","data":{"id":"57f50555"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 3.2 – Trajectory Tracking (20 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sFGKGheCt1"}],"identifier":"task-3-2-trajectory-tracking-20-pts","label":"Task 3.2 – Trajectory Tracking (20 pts)","html_id":"task-3-2-trajectory-tracking-20-pts","implicit":true,"key":"pLV1vHzLSD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"For this task, you need to track the optimal trajectory ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e0WNKWrM8s"},{"type":"inlineMath","value":"(x_d(t), u_d(t))","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>u</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_d(t), u_d(t))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">))</span></span></span></span>","key":"CSPcDqMOID"},{"type":"text","value":" you have generated in Task 3.1 using a continuous-time Model Predictive Controller (MPC). The controller will solve a finite-horizon optimal control problem at each time step to find a corrective input ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O7VcdMbN3K"},{"type":"inlineMath","value":"\\delta u(t)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\delta u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"yyhtda5mWB"},{"type":"text","value":" that minimizes deviations from the reference trajectory. The total control applied to the system is:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ech8lXBH0k"}],"key":"PfNzHREMrP"},{"type":"math","value":"u(t) = u_d(t) + \\delta u(t)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>u</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t) = u_d(t) + \\delta u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"12","key":"cjATTALzfC"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"This requires defining an ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ogUUxvw8XG"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"error system","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kus0uOQAlM"}],"key":"oktBjzm28Z"},{"type":"text","value":" where the state is the tracking error ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"p8xFNsuSUf"},{"type":"inlineMath","value":"e(t) = x(t) - x_d(t)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>x</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">e(t) = x(t) - x_d(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"gqtPzY3wdk"},{"type":"text","value":" and the input is the control error ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"f2Hyjxo2D3"},{"type":"inlineMath","value":"\\delta u(t)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\delta u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"d0rrFj0jh8"},{"type":"text","value":". The dynamics of this error system can be expressed as:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"MkMcBlZUzv"}],"key":"zFGl23hDir"},{"type":"math","value":"\\dot{e}(t) = f(x_d(t) + e(t), u_d(t) + \\delta u(t)) - f(x_d(t), u_d(t))","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>e</mi><mo>˙</mo></mover><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>e</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>u</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>−</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>u</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\dot{e}(t) = f(x_d(t) + e(t), u_d(t) + \\delta u(t)) - f(x_d(t), u_d(t))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">e</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0833em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">))</span></span></span></span></span>","enumerator":"13","key":"KY5E81aiXa"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Pl7Xzl4iyg"},{"type":"inlineMath","value":"f","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"jT0HVgj4Q2"},{"type":"text","value":" represents the nonlinear Acrobot dynamics.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BaZH69v8eV"}],"key":"jHrkKi0LEg"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"To implement the MPC tracker, you will:","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"hrY0oyAFMi"}],"key":"T01pVkfGPn"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create interpolants for your reference trajectory, ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"vijI2fNVel"},{"type":"inlineMath","value":"x_d(t)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x_d(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"ps8twGFHGv"},{"type":"text","value":" and ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"zRpLDnDdmz"},{"type":"inlineMath","value":"u_d(t)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u_d(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"YpoyfoQ0qt"},{"type":"text","value":", using the results from Task 3.1.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"oBuM4wIFEA"}],"key":"SbmQznrUT2"}],"key":"Y4j7BlX2bm"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Define the error dynamics as a new nonlinear system (e.g., ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"JEAm6Pp931"},{"type":"inlineCode","value":"acrobot_err_update","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"GtizCwA5eo"},{"type":"text","value":"). The Python code in the next cell provides a template for this.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"LZ2roF4efg"}],"key":"FcF23vHckL"}],"key":"tK1AMISvV1"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Define a quadratic cost function for the MPC that penalizes the error state ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"qh6aJOSB87"},{"type":"inlineMath","value":"e(t)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">e(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"Gmb8GZhQUT"},{"type":"text","value":" and the error input ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"yrxrF0lpwo"},{"type":"inlineMath","value":"\\delta u(t)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\delta u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"qvcmaVxk5f"},{"type":"text","value":" over a prediction horizon ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"HHw2T1fxdR"},{"type":"inlineMath","value":"T_h","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>h</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PNEAZcqIXi"},{"type":"text","value":":","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"n1jpwLyi1R"}],"key":"DYKLNixYGU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Trajectory cost: ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"TaMiIG0sRP"},{"type":"inlineMath","value":"\\int_0^{T_h} (e(\\tau)^T Q_x e(\\tau) + \\delta u(\\tau)^T Q_u \\delta u(\\tau)) \\, d\\tau","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><msub><mi>T</mi><mi>h</mi></msub></msubsup><mo stretchy=\"false\">(</mo><mi>e</mi><mo stretchy=\"false\">(</mo><mi>τ</mi><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><msub><mi>Q</mi><mi>x</mi></msub><mi>e</mi><mo stretchy=\"false\">(</mo><mi>τ</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>τ</mi><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><msub><mi>Q</mi><mi>u</mi></msub><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>τ</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>d</mi><mi>τ</mi></mrow><annotation encoding=\"application/x-tex\">\\int_0^{T_h} (e(\\tau)^T Q_x e(\\tau) + \\delta u(\\tau)^T Q_u \\delta u(\\tau)) \\, d\\tau</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3921em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0362em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.2579em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:-0.1389em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span></span></span></span>","key":"ajTlrXUXAb"},{"type":"text","value":".","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ofUKXU3nJU"}],"key":"dWeg2sHoSG"}],"key":"H1DhqRnNAw"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Terminal cost: ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"UbudKzVVHG"},{"type":"inlineMath","value":"e(T_h)^T P e(T_h)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo stretchy=\"false\">(</mo><msub><mi>T</mi><mi>h</mi></msub><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mi>P</mi><mi>e</mi><mo stretchy=\"false\">(</mo><msub><mi>T</mi><mi>h</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">e(T_h)^T P e(T_h)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"pkVxdwhv6S"},{"type":"text","value":".","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"xnSDzr6QKf"}],"key":"VB6XbkHaxo"}],"key":"OlKHm1i4j2"}],"key":"ykBDfeDNbG"}],"key":"rPUDtDv9np"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Define input constraints on the total control input, ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"PxZTZQdt0A"},{"type":"inlineMath","value":"|u(t)| \\le u_{\\max}= 5","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi><mo>≤</mo><msub><mi>u</mi><mi>max</mi><mo>⁡</mo></msub><mo>=</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">|u(t)| \\le u_{\\max}= 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">m</span><span class=\"mtight\">a</span><span class=\"mtight\">x</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"jznTrZ1qRb"},{"type":"text","value":" Nm. Since ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"mkgoeDxLGv"},{"type":"inlineMath","value":"u(t) = u_d(t) + \\delta u(t)","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>u</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t) = u_d(t) + \\delta u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"wW392NShKz"},{"type":"text","value":", the constraints on the MPC’s decision variable ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Kt2fkPdkZv"},{"type":"inlineMath","value":"\\delta u(t)","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\delta u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"MSS5TwIiSJ"},{"type":"text","value":" become time-varying:\n","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"mUeaMk3r9Y"}],"key":"hpe0rU5Imo"},{"type":"math","value":"-u_{\\max} - u_d(t) \\le \\delta u(t) \\le u_{\\max} - u_d(t)","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo>−</mo><msub><mi>u</mi><mi>max</mi><mo>⁡</mo></msub><mo>−</mo><msub><mi>u</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>≤</mo><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>≤</mo><msub><mi>u</mi><mi>max</mi><mo>⁡</mo></msub><mo>−</mo><msub><mi>u</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">-u_{\\max} - u_d(t) \\le \\delta u(t) \\le u_{\\max} - u_d(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">m</span><span class=\"mtight\">a</span><span class=\"mtight\">x</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">m</span><span class=\"mtight\">a</span><span class=\"mtight\">x</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"14","key":"exk0SCdgGD"}],"key":"RB2AEhVTD8"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create an ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"NJyhEPwKCs"},{"type":"inlineCode","value":"OptimalControlProblem","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"evNmpfjvsC"},{"type":"text","value":" for the error system using the tracking cost and time-varying input constraints.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"lPjTsCf7hy"}],"key":"Ipl3QORrLy"}],"key":"KMV5JZDrct"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Implement an MPC simulation loop that, at each time step:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"w7NQoIKFw6"}],"key":"ECV5rCdRUH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Calculates the current error ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"bvJTM07g7Y"},{"type":"inlineMath","value":"e(t) = x(t) - x_d(t)","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>x</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">e(t) = x(t) - x_d(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"pSy0LLfEFW"},{"type":"text","value":".","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"hQQ1s8jHjg"}],"key":"QwN9n7X0og"}],"key":"LtkE7p1V7C"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Updates the input constraints for the OCP based on the current reference input ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"cJGIEfsxe1"},{"type":"inlineMath","value":"u_d(t)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u_d(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"aBwAmZRdKK"},{"type":"text","value":".","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"dnkxaqd0EI"}],"key":"Uub8WMESFb"}],"key":"e2aC1J25PD"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Solves the OCP to get an optimal error input trajectory ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"m0KcEksBXo"},{"type":"inlineMath","value":"\\delta u(\\tau)","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>τ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\delta u(\\tau)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mclose\">)</span></span></span></span>","key":"YANlJfSj0l"},{"type":"text","value":" for the next ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"DAAYD4QJay"},{"type":"inlineMath","value":"T_h","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>T</mi><mi>h</mi></msub></mrow><annotation encoding=\"application/x-tex\">T_h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"bhjidTnpqS"},{"type":"text","value":" seconds.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"E2Detj5vE8"}],"key":"o5IPQpSv1I"}],"key":"KG0UrFo4y9"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Applies the first segment of the total control input ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"nUFSZhqAvZ"},{"type":"inlineMath","value":"u(t) = u_d(t) + \\delta u(t)","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>u</mi><mi>d</mi></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>δ</mi><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t) = u_d(t) + \\delta u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"hRPvwmH8PP"},{"type":"text","value":" to the true nonlinear Acrobot system.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"oYKIvOpaAA"}],"key":"bA2F9ZnqpW"}],"key":"d3NPiDisjw"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Simulates the system forward for a short duration and repeats the process.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"v27Zd3P6b6"}],"key":"TehgpXjjtd"}],"key":"MjR0QYqEz2"}],"key":"CPGhdujJ7I"}],"key":"zD0sRYhZr3"}],"key":"u6YtmANj7e"}],"identifier":"57f50555","label":"57f50555","html_id":"id-57f50555","key":"LY7YuDGHXe"},{"type":"block","kind":"notebook-code","data":{"id":"ae87dfd9"},"children":[{"type":"code","lang":"python","executable":true,"value":"def acrobot_err_update(t, e, du, params):\n    # e: error state (4,)\n    # du: error input (1,)  (delta torque)\n    xref = params['x_ref'](t).ravel()    # x_ref(t)\n    uref = params['u_ref'](t).ravel()[0] # scalar\n    x_tot = xref + e\n    u_tot = uref + du[0]\n\n    # total and reference dynamics\n    f_tot = acrobot_dynamics(t, x_tot, u_tot, params['plant_params'])\n    f_ref = acrobot_dynamics(t, xref, uref, params['plant_params'])\n\n    return f_tot - f_ref    # error dynamics\n\n\nacrobot_err = ctl.nlsys(\n    acrobot_err_update, None, name=\"acrobot_err\",\n    inputs=('du',),\n    outputs=('e1','e2','e3','e4'),\n    states=('e1','e2','e3','e4'),\n    params={\n        'x_ref': x_d,\n        'u_ref': u_d,\n        'plant_params': plant_params\n    }\n)\n\n# TODO: design MPC controller for trajectory tracking using acrobot_err system","identifier":"ae87dfd9-code","enumerator":"8","html_id":"ae87dfd9-code","key":"KHAtkcYeNy"},{"type":"outputs","id":"VOfS-2YDRsWJ587iONyb0","children":[],"identifier":"ae87dfd9-outputs","html_id":"ae87dfd9-outputs","key":"YmQpsjdgov"}],"identifier":"ae87dfd9","label":"ae87dfd9","html_id":"ae87dfd9","key":"yWiOuUcoE7"},{"type":"block","kind":"notebook-content","data":{"id":"14267326"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 4: Swing Up and then Stay (20 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zrw99Tav2G"}],"identifier":"task-4-swing-up-and-then-stay-20-pts","label":"Task 4: Swing Up and then Stay (20 pts)","html_id":"task-4-swing-up-and-then-stay-20-pts","implicit":true,"key":"JaW7oKjA48"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this task, you will combine your optimal swing-up trajectory and tracking controller (from Task 3) with your LQR stabilization controller around the upright (from Task 2) to build a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XdeQluNYGG"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"hybrid controller","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PbgL57ktrE"}],"key":"sEhuIJMLcL"},{"type":"text","value":" that:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"r3qfjrNVRT"}],"key":"ddqZPPZfMV"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Uses the trajectory-tracking controller to swing the Acrobot up from the downward position","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xD7n08X89H"}],"key":"KCe3xOpCy5"}],"key":"g4vYAX8Umk"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Automatically switches to the LQR controller when the Acrobot gets close to the upright position","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pt7Fw6XByI"}],"key":"VpDRMfSz2w"}],"key":"DSmuh6NUmK"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Maintains balance around the upright equilibrium using LQR control","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ZdoLVZI7YK"}],"key":"lIzrRCn6tx"}],"key":"iCT78m2RLk"}],"key":"m4fVYC6RfR"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Hybrid Control Strategy","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"nwyLaTC5CU"}],"identifier":"hybrid-control-strategy","label":"Hybrid Control Strategy","html_id":"hybrid-control-strategy","implicit":true,"key":"wsHp0QecxR"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The hybrid controller operates as a state machine with two modes:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"M7Qe2NNRGL"}],"key":"vPz0kbRNBj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Swing-up Mode","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"nbhiZCU2hD"}],"key":"JwAPkQ4XuA"},{"type":"text","value":": When the Acrobot is far from upright, use your MPC trajectory tracking controller from Task 3","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Ag3ZRayfx2"}],"key":"KY9oswGTGm"}],"key":"fv46xnHeQ6"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Stabilization Mode","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"YcZHCOItPI"}],"key":"HxsZFx9d0P"},{"type":"text","value":": When the Acrobot is near upright, switch to your LQR controller from Task 2","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"JiXUDs1IJO"}],"key":"w40k6fwsHW"}],"key":"LwySqBOOOS"}],"key":"nQt0CVhixP"},{"type":"heading","depth":3,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Implementation Requirements","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"QQx7dkhP2M"}],"identifier":"implementation-requirements","label":"Implementation Requirements","html_id":"implementation-requirements","implicit":true,"key":"T34rLdQDZU"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"You need to implement the following components:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"l79rWacLHn"}],"key":"q9NcmvDS22"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Controller Functions","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"NrQzWGpz6o"}],"key":"RJSJi4YIvG"},{"type":"text","value":" (adapt from your previous tasks):","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"AFIoZCkxVM"}],"key":"E3iNBeiT4H"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"u_track(x, t)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"R9z8DSVCEJ"},{"type":"text","value":": Your trajectory tracking controller from Task 3","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"fIaTVSX244"}],"key":"o0FPF58Zw8"}],"key":"wIAeNgUrHu"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"u_lqr(x)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"KGm979ThAX"},{"type":"text","value":": Your LQR controller from Task 2: ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"YaI33X4dnu"},{"type":"inlineMath","value":"u = -K(x - x_{eq}) + u_{eq}","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>=</mo><mo>−</mo><mi>K</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>u</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">u = -K(x - x_{eq}) + u_{eq}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BFpLFQJiB1"}],"key":"eyZdCWYoWD"}],"key":"zEEcOSUpqo"}],"key":"JAtLivtVI6"}],"key":"PFENvpTog6"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Switching Logic Functions","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"AXJs2Flplq"}],"key":"wynCeDiPdM"},{"type":"text","value":":","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Umnf2sRMh9"}],"key":"AX1D1i31zv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":25,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"should_switch_to_lqr(x)","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"FQEgPMr5u0"},{"type":"text","value":": Returns ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Kf4mNzus1N"},{"type":"inlineCode","value":"True","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"hncVxLrbU6"},{"type":"text","value":" when state is close enough to upright to switch to LQR","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"U6yhYG5vZb"}],"key":"EpNHNzYP6o"}],"key":"yuT2bQWirC"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"should_switch_to_swingup(x)","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"s5QRleXbeP"},{"type":"text","value":": Returns ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"kC48IHxwVO"},{"type":"inlineCode","value":"True","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"gxXoi8z0E2"},{"type":"text","value":" when state has drifted too far from upright (optional)","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"KLq0Gc3ZY8"}],"key":"nn0wbLCIjg"}],"key":"q3f1KNZYyb"}],"key":"tjw4lFIDIV"}],"key":"uJrlmvC3Q5"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Region Detection","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"mbLDXkqBsA"}],"key":"vcRXjOXdve"},{"type":"text","value":": Use the provided ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"TRWr9D77sh"},{"type":"inlineCode","value":"in_upright_region(x)","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"OL55GBb8VR"},{"type":"text","value":" function (see next cell) which defines a “capture region” around the upright equilibrium based on:","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"kZjKPXmYUE"}],"key":"MhsN706wyL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":29,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Angular position tolerances: ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"Kb9CLrkXpd"},{"type":"inlineMath","value":"|\\theta_1 - \\pi| < 0.25","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><msub><mi>θ</mi><mn>1</mn></msub><mo>−</mo><mi>π</mi><mi mathvariant=\"normal\">∣</mi><mo>&lt;</mo><mn>0.25</mn></mrow><annotation encoding=\"application/x-tex\">|\\theta_1 - \\pi| &lt; 0.25</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.25</span></span></span></span>","key":"mJe7szx27w"},{"type":"text","value":" rad, ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"sgOfwTFwFF"},{"type":"inlineMath","value":"|\\theta_2| < 0.5","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><msub><mi>θ</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi><mo>&lt;</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">|\\theta_2| &lt; 0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"LicR4cCqcJ"},{"type":"text","value":" rad","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"UpftuGdJNx"}],"key":"D98eWb1T8z"}],"key":"zSGSfpUdAn"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Angular velocity limits: ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"oCfGxhpuad"},{"type":"inlineMath","value":"|\\dot{\\theta}_1| < 1.0","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><msub><mover accent=\"true\"><mi>θ</mi><mo>˙</mo></mover><mn>1</mn></msub><mi mathvariant=\"normal\">∣</mi><mo>&lt;</mo><mn>1.0</mn></mrow><annotation encoding=\"application/x-tex\">|\\dot{\\theta}_1| &lt; 1.0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1813em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0556em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.0</span></span></span></span>","key":"vUy6ZMKyBh"},{"type":"text","value":" rad/s, ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"Czn0XenkBT"},{"type":"inlineMath","value":"|\\dot{\\theta}_2| < 1.0","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><msub><mover accent=\"true\"><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi><mo>&lt;</mo><mn>1.0</mn></mrow><annotation encoding=\"application/x-tex\">|\\dot{\\theta}_2| &lt; 1.0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1813em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9313em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0556em;\"><span class=\"mord\">˙</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.0</span></span></span></span>","key":"QJQrszYdBv"},{"type":"text","value":" rad/s","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"GSzWDmrHdb"}],"key":"kqe15xWo6S"}],"key":"EU8wdU9w6Q"}],"key":"VcNIWgZ6mo"}],"key":"bLOou2qDn2"}],"key":"EkZLpW7NBs"},{"type":"heading","depth":3,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Tasks to Complete:","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"ZO5jSHJWLu"}],"identifier":"tasks-to-complete","label":"Tasks to Complete:","html_id":"tasks-to-complete","implicit":true,"key":"oKo9bp9PHG"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":34,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Implement the hybrid controller","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"wB1kCDRnnq"}],"key":"oHN4ouQZJs"},{"type":"text","value":" using the template in the code cells below","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"MpHAEQEqLn"}],"key":"pK6vhClHWE"}],"key":"ezNmEBSQxt"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Test the controller","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"RMxJf0gT92"}],"key":"uOjerPcYrH"},{"type":"text","value":" starting from the downward hanging position: ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"VtXpz81v8g"},{"type":"inlineMath","value":"x_0 = [0, 0, 0, 0]","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">x_0 = [0, 0, 0, 0]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">]</span></span></span></span>","key":"wJDmSFnanQ"}],"key":"beVbo8HjoI"}],"key":"Ql2rO1GHHi"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Simulate and plot","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"g6tycboUx9"}],"key":"nqmJnoV7HR"},{"type":"text","value":":","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"CT7WzKL5V9"}],"key":"Z0FvDipshk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":37,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"State trajectories showing the swing-up and stabilization phases","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"XisEyi0L74"}],"key":"bsv1mTQ8ij"}],"key":"s1i9q3tGNP"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Control input over time","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"JhSaTJgfvv"}],"key":"wVFvPBnmI6"}],"key":"GVbLKvKJDB"},{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Mode switching events","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"t8u6KJrYqE"}],"key":"S06uKMhDch"}],"key":"mCWcgrynEB"}],"key":"i3NnvH4z4c"}],"key":"i5CjFrxss5"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Evaluate performance","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"Zs4bOp9kR6"}],"key":"QvcfsCpKnM"},{"type":"text","value":":","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"zZuJqFV5EK"}],"key":"SnbgYdvDu5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":41,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Does it successfully swing up and stabilize?","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"XLx7L7dYuJ"}],"key":"jSwN2fcGVe"}],"key":"QKLSheOoBB"},{"type":"listItem","spread":true,"position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How smooth is the transition between controllers?","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"vEwsr4Ge8H"}],"key":"cT98BuraFV"}],"key":"GxBSZYxGwv"},{"type":"listItem","spread":true,"position":{"start":{"line":43,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"What is the total time to reach and stabilize at upright?","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"uhUxKCUMSQ"}],"key":"OhLhIYUqF4"}],"key":"dkhgZzpuOo"}],"key":"WV0G7welK0"}],"key":"YnpyCPfqeh"}],"key":"RqHbUnhV5b"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"The code framework is provided in the following cells to help you get started.","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"Pw7VLYKH8T"}],"key":"euscYiIkqz"}],"identifier":"14267326","label":"14267326","html_id":"id-14267326","key":"gJdBjS0Grx"},{"type":"block","kind":"notebook-code","data":{"id":"e2579307"},"children":[{"type":"code","lang":"python","executable":true,"value":"def wrap_angle(angle):\n    \"\"\"Wrap angle to [-pi, pi).\"\"\"\n    return (angle + np.pi) % (2*np.pi) - np.pi\n\n# Thresholds for upright region, you can change them as needed\nth1_thresh = 0.25   # rad (~14 deg) around pi\nth2_thresh = 0.5    # rad (~29 deg) around 0\nw1_thresh  = 1.0    # rad/s\nw2_thresh  = 1.0    # rad/s\n\n# function to check if state is in upright region\ndef in_upright_region(x):\n    th1, th2, th1d, th2d = x\n    e_th1 = wrap_angle(th1 - np.pi)\n    e_th2 = wrap_angle(th2 - 0.0)\n\n    cond_angle = (abs(e_th1) < th1_thresh) and (abs(e_th2) < th2_thresh) # check angles\n    cond_vel   = (abs(th1d) < w1_thresh) and (abs(th2d) < w2_thresh) # check angular velocities\n\n    return cond_angle and cond_vel","identifier":"e2579307-code","enumerator":"9","html_id":"e2579307-code","key":"dwRcqc8B7M"},{"type":"outputs","id":"kHudrPapDBpBULY7QOvXk","children":[],"identifier":"e2579307-outputs","html_id":"e2579307-outputs","key":"B0ncwHkQRa"}],"identifier":"e2579307","label":"e2579307","html_id":"e2579307","key":"flYm4rqoB2"},{"type":"block","kind":"notebook-code","data":{"id":"2d4d59cd"},"children":[{"type":"code","lang":"python","executable":true,"value":"u_max = 5.0   # input limit for safety\nmode  = \"swingup\"   # initial mode\n\ndef hybrid_controller(x, t):\n    global mode\n\n    if mode == \"swingup\":\n        # 1) Use your trajectory-tracking controller (OCP/MPC/PD+FF)\n        u = u_track(x, t)\n\n        # 2) Check if we can switch to LQR\n        if should_switch_to_lqr(x):\n            mode = \"stabilize\"\n\n    elif mode == \"stabilize\":\n        # 1) Use LQR controller around upright\n        u = u_lqr(x)\n\n        # 2) Optionally: if we drift too far → go back to swing-up\n        if should_switch_to_swingup(x):\n            mode = \"swingup\"\n\n    else:\n        raise ValueError(\"Unknown mode: \" + mode)\n\n    # Saturate the torque for safety\n    u = float(np.clip(u, -u_max, u_max))\n    return u","identifier":"2d4d59cd-code","enumerator":"10","html_id":"id-2d4d59cd-code","key":"UDFPZdXlOU"},{"type":"outputs","id":"cuTaP4Y4iEPmiCa-eCKtP","children":[],"identifier":"2d4d59cd-outputs","html_id":"id-2d4d59cd-outputs","key":"kg5CqOCqQm"}],"identifier":"2d4d59cd","label":"2d4d59cd","html_id":"id-2d4d59cd","key":"soScN9o0dC"},{"type":"block","kind":"notebook-content","data":{"id":"53e4f099"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 5. Reinforcement Learning Control (25 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tLecp2Y3Sh"}],"identifier":"task-5-reinforcement-learning-control-25-pts","label":"Task 5. Reinforcement Learning Control (25 pts)","html_id":"task-5-reinforcement-learning-control-25-pts","implicit":true,"key":"YR9ftU73s1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Tasks 2 to 4 are based on model-based optimization and control to swing-up and balance the Acrobot. Another way to do it is to use RL. In this task, you will:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"waNkniAzHS"}],"key":"s3i6A4md6Q"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"op1xCJX1QR"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Gymnasium","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"r6rdyVG2ny"}],"key":"yLcEIxj0k9"},{"type":"text","value":" ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AHUAGQiX9k"},{"type":"inlineCode","value":"Acrobot-v1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KPQtLUkpQ9"},{"type":"text","value":" environment.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kmXVoOh5Td"}],"key":"SoKW5zpDoe"}],"key":"xweahEEund"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Implement and train an RL agent (e.g., ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gntbUxMWH2"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"PPO","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UOfSZxMoB9"}],"key":"EpNEbp2nRg"},{"type":"text","value":" algorithm from ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"FIiq0ZlDMB"},{"type":"inlineCode","value":"stable-baselines3","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sEqEHShfDY"},{"type":"text","value":").","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"IaeO727R5H"}],"key":"EEAXN0ESm2"}],"key":"iPzis5bl21"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Evaluate the trained policy: success rate, episode reward, qualitative behavior.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wk2elie0Sj"}],"key":"wqbEC0FyJb"}],"key":"NlzrltNpY2"}],"key":"zZSaCWybw2"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"xOllZngeMl"},{"type":"inlineCode","value":"Acrobot-v1","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"FHRuOfTC3W"},{"type":"text","value":" ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"a6rD3asVCS"},{"type":"link","url":"https://gymnasium.farama.org/environments/classic_control/acrobot/","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"environment","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kTFTQ1UwXr"}],"urlSource":"https://gymnasium.farama.org/environments/classic_control/acrobot/","key":"Tc6jCpsV6g"},{"type":"text","value":" has different characteristics compared to the continuous control problem in previous tasks:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OYe0fS6Mcm"}],"key":"jMNJ4H0zsH"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Environment Settings:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"LEWQglBosK"}],"key":"C3n23xqd64"}],"key":"ca6cHUPMoI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Actions","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"O80K3pBo8Y"}],"key":"BD4NDKPxBi"},{"type":"text","value":": 3 discrete actions (torque -1, 0, +1) vs. continuous torque in Tasks 1-4","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"izD0QSEKEn"}],"key":"y9khAZYpg0"}],"key":"XHmtF8L8YS"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Reward structure","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wkaFtS6K7u"}],"key":"McQgQIUHAl"},{"type":"text","value":": -1 per time step (encourages faster completion) vs. quadratic costs in optimal control","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Di2oyvTLri"}],"key":"GH6uvAb48s"}],"key":"gQk7uHhN5T"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Success criterion","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"a5mCo1eJhE"}],"key":"eC5fukAVx4"},{"type":"text","value":": End-effector height > 1.0 (approximately upright) vs. exact state targets","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"SlfzdaRFcC"}],"key":"DSN4uvYrYr"}],"key":"dKg6wzVyII"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Episode termination","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"X5mYiSF49P"}],"key":"iqWU7iiOhX"},{"type":"text","value":": Success OR maximum 500 steps vs. fixed time horizons","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"GgfRgylcs7"}],"key":"vXtobSwMxc"}],"key":"w2Dqy0Yy8f"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"No input penalties","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"PrReck3XwG"}],"key":"T2PZ4zXNXy"},{"type":"text","value":": Unlike LQR/MPC which penalize control effort","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"KhHTjaH9nt"}],"key":"PAN327Mh1N"}],"key":"sr5ipd7oR1"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Stochastic initial conditions","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ve9wprdU6Q"}],"key":"CgJd9BhLZZ"},{"type":"text","value":": Random start states vs. deterministic initial conditions","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"V5ELMiHPvM"}],"key":"Hs3D0pqic2"}],"key":"e0cutnslhB"}],"key":"FFO1Aiiyyf"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Key Differences from Model-Based Control:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"tzYWR6YBI8"}],"key":"dWp9RxI2p1"}],"key":"SMoGRcdghX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Objective","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Wwiythsgge"}],"key":"VC5sNUPqEN"},{"type":"text","value":": Minimize episode length (maximize reward) vs. minimize quadratic cost functionals","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"RxBEFHkZdL"}],"key":"BGKfsQv0H9"}],"key":"MdxUohI7dy"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Action space","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"wbl2xbppZu"}],"key":"SYE7u3jlE0"},{"type":"text","value":": Discrete bang-bang control vs. smooth continuous control","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"JZNBZlaeTO"}],"key":"qbBZciRYDf"}],"key":"L1ZELsAZQ3"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Learning approach","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"TvsCBIaaS9"}],"key":"uZwlsnXGMf"},{"type":"text","value":": Trial-and-error policy optimization vs. analytical/numerical optimal control","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"OpzUJZBpNE"}],"key":"qzdS6hQENx"}],"key":"Hz3W05Gqec"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Robustness","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"NN4EUN9mCu"}],"key":"iigL1VATb7"},{"type":"text","value":": Trained on distribution of initial states vs. designed for specific operating points","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"yy9RIw1Wxa"}],"key":"vd03znfayP"}],"key":"rNy1Kx5JvN"}],"key":"xGJheHFvTX"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"The following code cells demonstrate how to get a RL policy for the ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"NkhSnpUeqC"},{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"default","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"hBennSv4Ru"}],"key":"gRrzFN0uIg"},{"type":"text","value":" ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"q2FNwhhrEe"},{"type":"inlineCode","value":"Acrobot-v1","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"MyIGBpgWRu"},{"type":"text","value":" environment.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Zd0UcQwmq0"}],"key":"np2Y9h6utc"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Create Environment","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"h7ZaSYCZhT"}],"key":"QJv4xGPmSV"},{"type":"text","value":": Set up the Gymnasium ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"OucOdSPbrt"},{"type":"inlineCode","value":"Acrobot-v1","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"TUYkt1Qq00"},{"type":"text","value":" environment with appropriate observation and action spaces","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"eDACR9nEGd"}],"key":"xzex7heDxX"}],"key":"udTAANsudo"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Train RL Agent","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"pIPErISqaV"}],"key":"ERWkrS6vRL"},{"type":"text","value":": Use PPO from stable-baselines3 to learn a policy through interaction with the environment","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"uo7rBDahtI"}],"key":"mMhq7O3VE8"}],"key":"kRNctAm0RY"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Evaluate Performance","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"v5iHKeoazX"}],"key":"GiyZR3cZar"},{"type":"text","value":": Test the trained model on multiple episodes to assess success rate and behavior","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"niF6e64CNF"}],"key":"C4dMFAMD22"}],"key":"shzGCiStwh"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Visualize Results","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ewPSZtwnbM"}],"key":"WbvSJgZh1a"},{"type":"text","value":": Render the learned policy in action to qualitatively evaluate the swing-up strategy","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"DMUFnUrbqT"}],"key":"Wd5y1iAhEN"}],"key":"I9hp1q1g3u"}],"key":"WZWzvRvuDm"}],"identifier":"53e4f099","label":"53e4f099","html_id":"id-53e4f099","key":"car606pxqF"},{"type":"block","kind":"notebook-code","data":{"id":"a43c1c3f"},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create and inspect the Gymnasium Acrobot environment\nenv = gym.make(\"Acrobot-v1\", render_mode=None)\nobs, info = env.reset()\nprint(\"Observation space:\", env.observation_space)\nprint(\"Action space:\", env.action_space)\nprint(\"Initial observation:\", obs)\n\nenv.close()","identifier":"a43c1c3f-code","enumerator":"11","html_id":"a43c1c3f-code","key":"M3OQT5Ioiu"},{"type":"outputs","id":"W5GQIGjqGuJDbghpeXH-t","children":[],"identifier":"a43c1c3f-outputs","html_id":"a43c1c3f-outputs","key":"JIke5Rvbxx"}],"identifier":"a43c1c3f","label":"a43c1c3f","html_id":"a43c1c3f","key":"dYcaxd3KYg"},{"type":"block","kind":"notebook-content","data":{"id":"19b391e9"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After create the environement, we can train the model using PPO algorithm from stable baseline3 (you may modify hyperparameters, total timesteps, etc.):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dCfHXnGprA"}],"key":"yUWtvK8jsq"}],"identifier":"19b391e9","label":"19b391e9","html_id":"id-19b391e9","key":"l0xj6kloyi"},{"type":"block","kind":"notebook-code","data":{"id":"d292dbed"},"children":[{"type":"code","lang":"python","executable":true,"value":"from stable_baselines3 import PPO\nimport numpy as np\nfrom stable_baselines3.common.evaluation import evaluate_policy\n\n# Use the wrapper\nenv = gym.make(\"Acrobot-v1\")\nmodel = PPO(\"MlpPolicy\", env, verbose=1) # Create PPO model instance\nmodel.learn(total_timesteps=200_000) # Train for 200,000 timesteps\n\n# Save model\nmodel.save(\"ppo_acrobot\") # this will save the trained model to a zip file\n\n# Evaluate\nmean_reward, std_reward = evaluate_policy(model, env, n_eval_episodes=20)\nprint(f\"Mean reward over 20 eval episodes: {mean_reward:.2f} ± {std_reward:.2f}\")\n\nenv.close()","identifier":"d292dbed-code","enumerator":"12","html_id":"d292dbed-code","key":"ACbzxftPVH"},{"type":"outputs","id":"jmGKBuRAwQaJDqmPQng6z","children":[],"identifier":"d292dbed-outputs","html_id":"d292dbed-outputs","key":"TKLRWbsHyl"}],"identifier":"d292dbed","label":"d292dbed","html_id":"d292dbed","key":"NGkDjXYGBu"},{"type":"block","kind":"notebook-content","data":{"id":"5ee58885"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After that, we can evaluate and visualize the trained policy performance. The code below demonstrates the trained PPO agent in action by running several episodes with visual rendering enabled. This allows us to see how the agent swings up the acrobot. The visualization helps validate that the training was successful and provides intuition about the RL controller’s behavior.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IHsDFq6uRU"}],"key":"dmhuo8Skgu"}],"identifier":"5ee58885","label":"5ee58885","html_id":"id-5ee58885","key":"e3J6gPD28o"},{"type":"block","kind":"notebook-code","data":{"id":"1ea2e2c3"},"children":[{"type":"code","lang":"python","executable":true,"value":"import gymnasium as gym\nfrom stable_baselines3 import PPO\nfrom stable_baselines3.common.vec_env import VecVideoRecorder, DummyVecEnv\nfrom IPython.display import Video\n\n# Create a vectorized environment for video recording\ndef make_env():\n    return gym.make(\"Acrobot-v1\", render_mode=\"rgb_array\")\n\nenv = DummyVecEnv([make_env])\n\n# Wrap with video recorder\nenv = VecVideoRecorder(\n    env,\n    \"videos/\",\n    record_video_trigger=lambda x: x == 0,  # Record first episode\n    video_length=500,  # Maximum video length\n    name_prefix=\"acrobot_ppo\"\n)\n\n# Load the trained model\nmodel = PPO.load(\"ppo_acrobot\")\n\n# Run one episode with video recording\nobs = env.reset()\nfor _ in range(500):\n    action, _ = model.predict(obs, deterministic=True)\n    obs, reward, done, info = env.step(action)\n    if done[0]:\n        break\n\nenv.close()\n\n# Display the recorded video\nVideo(\"videos/acrobot_ppo-step-0-to-step-500.mp4\", width=600)","identifier":"1ea2e2c3-code","enumerator":"13","html_id":"id-1ea2e2c3-code","key":"uiI1IsUTCE"},{"type":"outputs","id":"NnDKin9xZiIzGlk_t4FDq","children":[],"identifier":"1ea2e2c3-outputs","html_id":"id-1ea2e2c3-outputs","key":"N6giNaE3Lr"}],"identifier":"1ea2e2c3","label":"1ea2e2c3","html_id":"id-1ea2e2c3","key":"R6njZ1S05g"},{"type":"block","kind":"notebook-content","data":{"id":"1c4849b4"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 5.1 – Evaluation and Analysis for default Gymnasium ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Blxe1W326y"},{"type":"inlineCode","value":"Acrobot-v1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XDsGwAmOeV"},{"type":"text","value":" environment  (5 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qmQt2m3Oxg"}],"identifier":"task-5-1-evaluation-and-analysis-for-default-gymnasium-acrobot-v1-environment-5-pts","label":"Task 5.1 – Evaluation and Analysis for default Gymnasium Acrobot-v1 environment  (5 pts)","html_id":"task-5-1-evaluation-and-analysis-for-default-gymnasium-acrobot-v1-environment-5-pts","implicit":true,"key":"eBpmlJFcHm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"After training your PPO agent, you need to analyze its behavior and performance. Run the evaluation code above and then address the following questions:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yocJ8LlUR9"}],"key":"kxSDeDH9QH"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Questions to Answer:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zDQe6jHTQb"}],"key":"PvsVX04vzr"}],"key":"me17DXt5VL"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"State Trajectory Analysis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"A3po7jeydA"}],"key":"XqmpQFSSPp"},{"type":"text","value":": Plot the joint angles ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"evIhUa2nHO"},{"type":"inlineMath","value":"\\theta_1(t)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\theta_1(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"Z06zZvhKLW"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"w7mwyjiCtC"},{"type":"inlineMath","value":"\\theta_2(t)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\theta_2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"lajm4X2Fw3"},{"type":"text","value":" with respect to time for several episodes. What patterns do you observe in the learned policy’s swing-up strategy?","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yvCwwZ1lap"}],"key":"sVoTBLLdCN"}],"key":"BIXO03vKmt"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Tip Height Analysis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Lbn4L9LvG0"}],"key":"eFscDamuUX"},{"type":"text","value":": Plot the tip’s height with respect to time. The tip height can be calculated as: ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"abBZh5yh6s"},{"type":"inlineCode","value":"height = -cos(θ₁) - cos(θ₁ + θ₂)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BRWC6egEkC"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uZC5IAk3F8"}],"key":"LO5hZPpZ6b"}],"key":"UcN3ogFyc3"}],"key":"aabCiw0Mj4"},{"type":"image","url":"/49dde7a163196b57e7f14e5f17be486f.gif","alt":"tip height","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"N0YMlQkbNI","urlSource":"https://gymnasium.farama.org/_images/acrobot.gif"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"You should notice that the acrobot swings up but doesn’t get to the upright position (θ₁ = π, θ₂ = 0). Instead, it typically terminates the episode once the tip height exceeds 1.0.  This is because the default Gymnasium ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"nh7SEVunnf"},{"type":"inlineCode","value":"Acrobot-v1","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"QuBFG6YRzS"},{"type":"text","value":" environment has a ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"oTKo4EMZVW"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"sparse reward structure","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"e0e1ytkOuW"}],"key":"sE3OdN3Ksu"},{"type":"text","value":" that differs significantly from optimal control formulations:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"yFFirzrWuG"}],"key":"mTLoWom2Lg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Termination condition","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Jc5Lxo3Id3"}],"key":"rKl1t8jjrM"},{"type":"text","value":": Episode ends when tip height > 1.0","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"rzyKJ9DTWg"}],"key":"Te7RhNuO9T"}],"key":"FXQFvnrMdo"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Reward signal","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"BfmFT9PZKY"}],"key":"ChHLbBOkpb"},{"type":"text","value":": -1 per time step (encourages faster completion)","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"XThatjUL1j"}],"key":"NwQA0LGy6z"}],"key":"SZIbecZDsC"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"No balancing phase","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"R5bFKuw1Is"}],"key":"syFw1bBZY2"},{"type":"text","value":": Once the success condition is met, the episode terminates immediately","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Kw6JO510ic"}],"key":"CvOEB8sEb4"}],"key":"lrxITrPYc6"}],"key":"GJRfCGOTWr"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"This means the RL agent learns to ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"vYakqHn25F"},{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Swing up quickly","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"yfya0Z6gI0"}],"key":"RU3HkLTmHy"},{"type":"text","value":" to minimize the negative reward accumulation, ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ZSFtnnlfV2"},{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"reach the target height","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"BtgI0XKIPz"}],"key":"yFaciy5V2C"},{"type":"text","value":" as fast as possible, and it does ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"VzSP3QvIg9"},{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"not learn balancing behavior","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"pDrgoOOY82"}],"key":"j6K32cpBBT"},{"type":"text","value":" since the episode ends upon reaching the goal. This is fundamentally different from the model-based controllers you designed in Tasks 2-4, which were formulated to both reach AND maintain the upright equilibrium. The RL agent essentially learns only the “swing-up phase” without the “stabilization phase.” This difference highlights an important consideration in RL problem formulation: the reward structure directly shapes the learned behavior. To make the acrobot fully upright, you would need to modify the environment with different rewards.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"J93KjUTd9I"}],"key":"gI7ISPN7uC"}],"identifier":"1c4849b4","label":"1c4849b4","html_id":"id-1c4849b4","key":"VoQT3EOdya"},{"type":"block","kind":"notebook-content","data":{"id":"033cb305"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 5.2 – Train a Stablization Policy (5 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IwUxmDzNl7"}],"identifier":"task-5-2-train-a-stablization-policy-5-pts","label":"Task 5.2 – Train a Stablization Policy (5 pts)","html_id":"task-5-2-train-a-stablization-policy-5-pts","implicit":true,"key":"OvFKOBYqnq"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we can try to revise the default setting to make it similar to model-based approach. To do this, we will do two things through the wrapper of gym:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OkiS27K4xW"}],"key":"tL5sRSglkg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Convert the problem to be continuous","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"u45tquLLLF"}],"key":"tQSwWw6qVk"}],"key":"nxfxw9eJkE"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use a new reward function similar to the cost function we have used in trajectory optimization","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"zS9t8FFaxp"}],"key":"VH5lhHCh3q"}],"key":"hGb4KzpwAP"}],"key":"ldC6dBNpM8"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"What is a Gym ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DPqkAknW4a"},{"type":"link","url":"https://gymnasium.farama.org/introduction/basic_usage/#modifying-the-environment","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Wrapper","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EmYUMRGhbT"}],"urlSource":"https://gymnasium.farama.org/introduction/basic_usage/#modifying-the-environment","key":"J60n6Usaus"},{"type":"text","value":"?","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"dTp5hiQRzn"}],"key":"Aifm5fyfFI"}],"key":"OtUHW1AzuZ"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"A wrapper is a design pattern that allows us to modify the behavior of an existing environment without creating an entirely new one from scratch. Wrappers “wrap around” the original environment and can modify:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"qsiRCTwDkO"}],"key":"biXHIGJP7V"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Action spaces (discrete → continuous)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"fjLwllL1q9"}],"key":"C0aw8zJMH3"}],"key":"qU2XJ9qa8N"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Observation spaces","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"TxYD6aAmGN"}],"key":"aSxzPXkMfa"}],"key":"uW8DdUmHMm"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reward functions","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"eSfMNEMuEw"}],"key":"VSQIBJmqAK"}],"key":"tLohqYCBK2"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Episode termination conditions","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"wT8VZbtD7s"}],"key":"JGYwGsXrYO"}],"key":"PXWoWnvcav"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Any other environment behavior","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"DsWTwIU30J"}],"key":"yIIJvY0tFA"}],"key":"ej6aU8yzKb"}],"key":"RaN1r1dKRJ"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Why Use Wrappers Instead of Creating New Environments?","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"F4fAwH9UwP"}],"key":"nzv9ANuapG"}],"key":"ZkPCzK7k2l"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Reusability","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"UrFcXWRVqA"}],"key":"mFOUUJmfhf"},{"type":"text","value":": We can apply the same modifications to different base environments","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"DNiv1hQCqW"}],"key":"b9tbRQ6HlY"}],"key":"vKPt4rCwyj"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Modularity","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"BJP975Rd4C"}],"key":"MCFRSOSZq3"},{"type":"text","value":": Each wrapper handles one specific modification, making code more organized","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"BQHWsv7dXw"}],"key":"S1Rduhsm7l"}],"key":"wCpcAGzUEU"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Maintainability","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"OcwfsS8vwh"}],"key":"iIkv5FuTny"},{"type":"text","value":": Changes to the base environment automatically propagate to wrapped versions","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Pui1sijnNC"}],"key":"ME5BV0c0fA"}],"key":"U6TXC0J9Px"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Efficiency","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"jcIA5B2ECF"}],"key":"WPDruzEdSL"},{"type":"text","value":": We leverage the existing, well-tested Gymnasium implementation rather than reimplementing dynamics","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"XPFSt28u4V"}],"key":"jgFvRahEEm"}],"key":"lMjeTiEj5W"}],"key":"xXmJXZ7vJZ"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"In our case, we’ll use two wrappers:","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"tKzWca9YBg"}],"key":"spWyGXZovy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"ContinuousAcrobotActionWrapper","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"lnHxYuTBAk"},{"type":"text","value":": Converts discrete actions {-1, 0, +1} to continuous torque values","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"qahKh6qzr5"}],"key":"bVwJ2oG28l"}],"key":"rJkpqg5R83"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"AcrobotOCPRewardWrapper","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"tTh5PmL7N3"},{"type":"text","value":": Replaces the sparse -1 reward with a customized reward similar to optimal control","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"pomx6FcGEv"}],"key":"L29fSDi4tU"}],"key":"B6YZG8hLDP"}],"key":"gjQJgy8lww"}],"identifier":"033cb305","label":"033cb305","html_id":"id-033cb305","key":"nqMnEpVIzR"},{"type":"block","kind":"notebook-code","data":{"id":"b1e2144c"},"children":[{"type":"code","lang":"python","executable":true,"value":"import gymnasium as gym\nfrom gymnasium import spaces\nimport numpy as np\n\n# Action wrapper to convert discrete actions to continuous torque\nclass ContinuousAcrobotActionWrapper(gym.Wrapper):\n    \"\"\"\n    Convert discrete Acrobot-v1 actions into continuous torque in [-torque_limit, torque_limit].\n    The underlying env is still Acrobot-v1, but we override the torque used in the dynamics.\n    \"\"\"\n    def __init__(self, env, torque_limit=5.0):\n        super().__init__(env)\n        self.torque_limit = float(torque_limit)\n        # Continuous 1-D action: torque in [-torque_limit, torque_limit]\n        self.action_space = spaces.Box(\n            low=np.array([-self.torque_limit], dtype=np.float32),\n            high=np.array([self.torque_limit], dtype=np.float32),\n            dtype=np.float32,\n        )\n        # for reward wrapper\n        self.unwrapped.last_u = 0.0\n\n    def reset(self, **kwargs):\n        obs, info = self.env.reset(**kwargs)\n        self.unwrapped.last_u = 0.0\n        return obs, info\n\n    def step(self, action):\n        # action is expected to be a 1D array or scalar; clip to [-torque_limit, torque_limit]\n        if isinstance(action, np.ndarray):\n            u = float(action.squeeze())\n        else:\n            u = float(action)\n        u = np.clip(u, -self.torque_limit, self.torque_limit)\n        self.unwrapped.last_u = u\n\n        # Hack: temporarily set AVAIL_TORQUE so that super().step(1) uses our u\n        orig_avail = self.env.unwrapped.AVAIL_TORQUE.copy()\n        self.env.unwrapped.AVAIL_TORQUE[:] = [u, u, u]\n\n        # Use middle index (1) – all entries are the same anyway\n        obs, reward, terminated, truncated, info = self.env.step(1)\n\n        # Restore original discrete torque set\n        self.env.unwrapped.AVAIL_TORQUE[:] = orig_avail\n\n        return obs, reward, terminated, truncated, info\n\n# Reward wrapper to implement OCP-like reward\nclass AcrobotOCPRewardWrapper(gym.Wrapper):\n    \"\"\"\n    Replace Acrobot reward by r = -u^T Q_u u + height reward + terminal bonus (on success).\n    Assumes the wrapped env sets env.unwrapped.last_u to the actual torque used.\n    \"\"\"\n    def __init__(self, env, Q_u=1.0, height_weight=5.0, terminal_bonus=200.0,\n                 failure_penalty=0.0, success_height_threshold=1.8):\n        super().__init__(env)\n        self.Q_u = float(Q_u)\n        self.height_weight = float(height_weight) # weight for height reward\n        self.terminal_bonus = float(terminal_bonus) # bonus for success\n        self.failure_penalty = float(failure_penalty) # penalty on failure (timeout)\n        self.success_height_threshold = float(success_height_threshold)  # height threshold for success\n\n    def step(self, action):\n        obs, _, terminated, truncated, info = self.env.step(action)\n\n        u = float(getattr(self.env.unwrapped, \"last_u\", 0.0))\n        cos_th1, sin_th1, cos_th2, sin_th2, th1_dot, th2_dot = obs\n\n        height = -cos_th1 - (cos_th1 * cos_th2 - sin_th1 * sin_th2)\n\n        # Reward components\n        height_reward = self.height_weight * height\n        control_cost = self.Q_u * (u ** 2)\n        velocity_penalty = 0.01 * (th1_dot**2 + th2_dot**2)\n        reward = height_reward - control_cost - velocity_penalty\n\n        # OVERRIDE termination logic: only terminate if reaching near-upright (height > 1.8)\n        # or if episode times out (truncated)\n        if height >= self.success_height_threshold:\n            terminated = True  # True success\n            reward += self.terminal_bonus\n        else:\n            terminated = False  # Keep going even if original env terminated at height > 1\n\n        if truncated and self.failure_penalty != 0.0:\n            reward -= self.failure_penalty\n\n        return obs, reward, terminated, truncated, info","identifier":"b1e2144c-code","enumerator":"14","html_id":"b1e2144c-code","key":"fSwh4Hm3Hd"},{"type":"outputs","id":"68doTfzWrE99X6F4CL0zi","children":[],"identifier":"b1e2144c-outputs","html_id":"b1e2144c-outputs","key":"u3sXCHZpdf"}],"identifier":"b1e2144c","label":"b1e2144c","html_id":"b1e2144c","key":"zSADZvWVZm"},{"type":"block","kind":"notebook-code","data":{"id":"3a95412f"},"children":[{"type":"code","lang":"python","executable":true,"value":"from stable_baselines3 import PPO\nfrom stable_baselines3.common.env_util import make_vec_env\n\n# Function to create the wrapped Acrobot environment\ndef make_acrobot_ocp_env():\n    base_env = gym.make(\"Acrobot-v1\")\n    env = ContinuousAcrobotActionWrapper(base_env, torque_limit=5.0)\n    env = AcrobotOCPRewardWrapper(\n        env,\n        Q_u=0.1,\n        height_weight=5.0,\n        terminal_bonus=200.0,\n        success_height_threshold=1.7  # Require height for success, you may start with a smaller value so that it is easier to learn\n    )\n    return env\n\nvec_env = make_vec_env(make_acrobot_ocp_env, n_envs=8) # Vectorized environment for parallel training\n\nmodel = PPO(\"MlpPolicy\", vec_env, verbose=1)\nmodel.learn(total_timesteps=500_000)  # May need more timesteps\nmodel.save(\"ppo_acrobot_ocp_continuous\")","identifier":"3a95412f-code","enumerator":"15","html_id":"id-3a95412f-code","key":"wrLbUonvrS"},{"type":"outputs","id":"CV4R09zgQG4uV7oYkiysi","children":[],"identifier":"3a95412f-outputs","html_id":"id-3a95412f-outputs","key":"A3oNwcrPin"}],"identifier":"3a95412f","label":"3a95412f","html_id":"id-3a95412f","key":"TlOi3Fh4O6"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/","height":708},"executionInfo":{"elapsed":363,"status":"ok","timestamp":1765083560141,"user":{"displayName":"Jianguo Zhao","userId":"09996222056778326224"},"user_tz":420},"id":"17ec3b6e","outputId":"323335cc-3f75-4b10-99e3-c2d2cd4c424e"},"children":[{"type":"code","lang":"python","executable":true,"value":"from stable_baselines3 import PPO\nfrom stable_baselines3.common.vec_env import VecVideoRecorder, DummyVecEnv\nfrom IPython.display import Video\n\n# Create the wrapped environment with rgb_array render mode for video recording\ndef make_acrobot_ocp_env_visual():\n    base_env = gym.make(\"Acrobot-v1\", render_mode=\"rgb_array\")\n    env = ContinuousAcrobotActionWrapper(base_env, torque_limit=5.0)\n    env = AcrobotOCPRewardWrapper(\n        env,\n        Q_u=0.1,\n        height_weight=5.0,\n        terminal_bonus=200.0,\n        success_height_threshold=1.7\n    )\n    return env\n\n# Create vectorized environment for video recording\nenv = DummyVecEnv([make_acrobot_ocp_env_visual])\n\n# Wrap with video recorder\nenv = VecVideoRecorder(\n    env,\n    \"videos/\",\n    record_video_trigger=lambda x: x == 0,  # Record first episode\n    video_length=500,\n    name_prefix=\"acrobot_ocp_continuous\"\n)\n\n# Load the trained model\nmodel = PPO.load(\"ppo_acrobot_ocp_continuous\")\n\n# Run one episode with video recording\nobs = env.reset()\nfor _ in range(500):\n    action, _ = model.predict(obs, deterministic=True)\n    obs, reward, done, info = env.step(action)\n    if done[0]:\n        break\n\nenv.close()\n\n# Display the recorded video\nVideo(\"videos/acrobot_ocp_continuous-step-0-to-step-500.mp4\",embed=True, width=600)","identifier":"17ec3b6e-code","enumerator":"16","html_id":"id-17ec3b6e-code","key":"mLiKbJAduw"},{"type":"outputs","id":"j_6phaZiUMbHURO0-aTOA","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Moviepy - Building video /content/videos/acrobot_ocp_continuous-step-0-to-step-500.mp4.\nMoviepy - Writing video /content/videos/acrobot_ocp_continuous-step-0-to-step-500.mp4\n\n"},"children":[],"identifier":"17ec3b6e-outputs-0","html_id":"id-17ec3b6e-outputs-0","key":"i2KZzduuYU"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"                                                   "},"children":[],"identifier":"17ec3b6e-outputs-1","html_id":"id-17ec3b6e-outputs-1","key":"u2elv3pwk6"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Moviepy - Done !\nMoviepy - video ready /content/videos/acrobot_ocp_continuous-step-0-to-step-500.mp4\n"},"children":[],"identifier":"17ec3b6e-outputs-2","html_id":"id-17ec3b6e-outputs-2","key":"HrxIrEw3aU"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"\r"},"children":[],"identifier":"17ec3b6e-outputs-3","html_id":"id-17ec3b6e-outputs-3","key":"OONtyLzGDp"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"f7145affb3556bf98b131d9a3332c77e","path":"/f7145affb3556bf98b131d9a3332c77e.html"},"text/plain":{"content":"<IPython.core.display.Video object>","content_type":"text/plain"}}},"children":[],"identifier":"17ec3b6e-outputs-4","html_id":"id-17ec3b6e-outputs-4","key":"OYmpUGJA9D"}],"identifier":"17ec3b6e-outputs","html_id":"id-17ec3b6e-outputs","key":"DGvevi0AvD"}],"identifier":"17ec3b6e","label":"17ec3b6e","html_id":"id-17ec3b6e","key":"z2gjBR2lES"},{"type":"block","kind":"notebook-content","data":{"id":"e9d14e16"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Tasks:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yRba7xBx2P"}],"key":"ncU1mwkPH2"}],"key":"VDheRtIqQf"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Train models with different ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vRmRwzWauW"},{"type":"inlineCode","value":"success_height_threshold","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"mq1Mg7kUaI"},{"type":"text","value":" values (keep ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZK34z1sPPL"},{"type":"inlineCode","value":"Q_u = 0.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"snS1ForAwW"},{"type":"text","value":", ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"m6U2i9P4gi"},{"type":"inlineCode","value":"height_weight = 5.0","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"x6yQcxOVgI"},{"type":"text","value":"):","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"G5KYBtu7Fc"}],"key":"O0LYU70gIR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Easy: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HJgIURDFVJ"},{"type":"inlineCode","value":"success_height_threshold = 1.5","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lor1o6ND4h"}],"key":"fAp9aBwJEr"}],"key":"If9aqWJmsf"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Medium: ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"pGGubWioy9"},{"type":"inlineCode","value":"success_height_threshold = 1.7","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bKqHzNaDhB"},{"type":"text","value":" (baseline)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UMLwxmx1wS"}],"key":"y3OZ2Ygv2S"}],"key":"TV0u4oXlYL"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hard: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wokmLRfK7L"},{"type":"inlineCode","value":"success_height_threshold = 1.85","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"azeHQ4yNi2"}],"key":"qiHpId00m2"}],"key":"S3dT02DWm4"}],"key":"jG5V7iL41A"}],"key":"iOThfIws4p"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"For each threshold, plot for 5 sample episodes:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xzVrDSsNl2"}],"key":"K8PrcP7fNT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tip height vs time","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LDZg6U6yRA"}],"key":"CThFowgX2I"}],"key":"FrLkQ8iyBq"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Control input (torque) vs time","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"mMZPZqxkPf"}],"key":"fcPSxuodv8"}],"key":"b5PuLRMfUM"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Explain the results you have obtained.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"PHJ4L1x4CP"}],"key":"dcFlDLrbbq"}],"key":"k7WqsQmQR4"}],"key":"QpZRNasaEK"}],"key":"PBpQntJvD5"}],"key":"Z3vF5bArWC"}],"identifier":"e9d14e16","label":"e9d14e16","html_id":"e9d14e16","key":"TkoVEGbrlv"},{"type":"block","kind":"notebook-content","data":{"id":"a50ddbb4"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 5.3 – Train a Swing-up Policy (10 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uCukYy7B8E"}],"identifier":"task-5-3-train-a-swing-up-policy-10-pts","label":"Task 5.3 – Train a Swing-up Policy (10 pts)","html_id":"task-5-3-train-a-swing-up-policy-10-pts","implicit":true,"key":"QpfH8tjg1F"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this task, you will train a policy that can swing the Acrobot up from the downward position. The goal here is only to achieve swing-up to a target height, not to maintain balance afterward. The episode will terminate upon reaching the target height.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ab5zdCMISY"}],"key":"ckP4ONiBqR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The code below implements this using:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MPrsrZ8SeW"}],"key":"ZF3q3OkxYE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Continuous torque via ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Xn6ldcmjd8"},{"type":"inlineCode","value":"ContinuousAcrobotActionWrapper","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"mXum9uguvG"}],"key":"ELrqcqjj2z"}],"key":"MRS4PRgCEN"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A swing-up-specific reward and termination with ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RuzyMl2hIx"},{"type":"inlineCode","value":"AcrobotSwingUpWrapper","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QixZ4yOMui"}],"key":"aW684N03WJ"}],"key":"r17ET8Ms2X"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Success defined by reaching a tip height threshold (e.g., 1.8)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rDnV157Vz7"}],"key":"Z3JV8yNgTV"}],"key":"sOYrcnLCly"}],"key":"vOwtoW4TP1"},{"type":"heading","depth":4,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Design Considerations","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"sfHlC4bFJk"}],"identifier":"design-considerations","label":"Design Considerations","html_id":"design-considerations","implicit":true,"key":"wVRgbubdWv"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Termination: Terminate the episode when the tip height exceeds the success threshold (swing-up achieved); Otherwise, terminate on timeout (max steps)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"l5IsQMd3UL"}],"key":"pXT5fzE4yb"}],"key":"aHYfpKgfib"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Reward Function (Swing-up only): the reward function should encourage upward movement via height reward; discourage staying near the downward configuration; penalize large control effort, among others.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"lvxNYFGGEz"}],"key":"k1B4nLIjFo"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"You will need to play with the reward function to obtain the correct behaviror","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"m2SqtxtGUj"}],"key":"KfezSrh5SF"}],"key":"d2ntOiKwvE"}],"key":"dyjyRcONvV"}],"key":"DW8qWOMBVf"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Suggested reward structure:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"w17LWJErJR"}],"key":"HlsYWEdpQC"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Height reward: encourages swing-up","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"QT3nvQyzHW"}],"key":"u1iLHJ9kuR"}],"key":"AvEHnT3k22"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Downward penalty: discourages staying down","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"DHYn7JDd15"}],"key":"t0CjTR6Uq2"}],"key":"rfpD8i955Z"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Control penalty: promotes energy efficiency","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"mOul1206lr"}],"key":"nI2yCTdtsy"}],"key":"Gr5kWq8G3a"}],"key":"HLJtIcXD0o"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Example (as implemented below):","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Q08rfn8Ylu"}],"key":"bBzmDpiEoK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"reward = height_weight * height - downward_penalty - control_cost * u^2","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"d1D4XSohOZ"}],"key":"bFxmjCx9Kg"}],"key":"cC1tI9Z1Ux"}],"key":"nPBtGRvvxw"},{"type":"heading","depth":4,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Training Setup","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"iWS3fCzHb4"}],"identifier":"training-setup","label":"Training Setup","html_id":"training-setup","implicit":true,"key":"iSN4eGJIBW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Train for 300k–700k timesteps","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"zqvgEZx37x"}],"key":"JJXftDBPPw"}],"key":"Uj7v6c27vH"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tune hyperparameters:","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"nxHSU23SX2"}],"key":"i1emIf7goo"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":29,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"height_weight","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"RLi3oWXSym"},{"type":"text","value":": 5–15","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"Ey4879RJWI"}],"key":"LfrlqOztfB"}],"key":"p1Ut85C9tC"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"control_cost","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"RDhloIPOXn"},{"type":"text","value":": 0.05–0.2","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"jjG2oUMpr1"}],"key":"CSbWTkYdnc"}],"key":"m8PqCT4KzX"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"success_height","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ubVI0IGct6"},{"type":"text","value":": 1.7–1.9","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"xytZqavJ2A"}],"key":"U2joGZ050M"}],"key":"koxwtqGmpj"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"downward_penalty","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"UKQEqgGFxg"},{"type":"text","value":": 3–10","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"zEfomHmoYJ"}],"key":"FEw0jFbaVm"}],"key":"FVMFpHxKw8"}],"key":"YNT8dHoXYY"}],"key":"oF4SkSoBEv"}],"key":"HTxCpKIHwP"},{"type":"heading","depth":4,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Evaluation","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"v4QA0Tv0Ph"}],"identifier":"evaluation","label":"Evaluation","html_id":"evaluation","implicit":true,"key":"PbZlwnKKD1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":35,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Start from the downward position and check if the agent reaches the target height","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"mump5M9Leq"}],"key":"s6r0ywV175"}],"key":"pyTwk0dL37"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plot tip height over time to verify swing-up completion","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"MJ17LXW1Ok"}],"key":"fqMdRBmYCb"}],"key":"XF46dxVXvu"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Note: The agent is not trained to balance; episodes end upon success","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"QEVp41MEDk"}],"key":"lHd1ORNRoT"}],"key":"jKDNrfuRic"}],"key":"WxUqUko3rl"},{"type":"heading","depth":4,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Using GPU Acceleration in Google Colab","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"qO4uyggFbv"}],"identifier":"using-gpu-acceleration-in-google-colab","label":"Using GPU Acceleration in Google Colab","html_id":"using-gpu-acceleration-in-google-colab","implicit":true,"key":"gAFkz7zYt9"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Training RL policies can be time-consuming on CPU. You can get free compute credits through:\n","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"XsYcbeWGKC"},{"type":"link","url":"https://colab.research.google.com/signup","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"https://​colab​.research​.google​.com​/signup","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"nYL2oto6bS"}],"urlSource":"https://colab.research.google.com/signup","key":"MvdGzys3En"}],"key":"uoRBK5K0YH"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"This will allow you to use GPUs in the cloud to speed up training in Google Colab:","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"YhH18JZEMz"}],"key":"sMiJAWlobQ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":45,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Enable GPU runtime: Runtime → Change runtime type → Hardware accelerator → GPU (T4 or better)","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"wA6EXZ0sq2"}],"key":"O7e3EKkMEq"}],"key":"obtUxJGEw8"},{"type":"listItem","spread":true,"position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Verify GPU availability: Run ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"pie3YcP9LY"},{"type":"inlineCode","value":"!nvidia-smi","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"QXzRV13Mvd"}],"key":"R9cx6DaOtg"}],"key":"r9ixR7srZu"},{"type":"listItem","spread":true,"position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"PyTorch will automatically use GPU (Stable-Baselines3 runs on PyTorch)","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"eDLH3EYzuu"}],"key":"SQXzcU6pQT"}],"key":"wh73pOsuJN"},{"type":"listItem","spread":true,"position":{"start":{"line":48,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Expected speedup: A 30–60 min CPU run can complete in 5–15 min on GPU","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"YBfcsOYhZP"}],"key":"IXbFTAyeq7"}],"key":"NxA2HImexN"}],"key":"TAmmO8vzS0"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"You can save checkpoints with ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"z3wTbs0EZ0"},{"type":"inlineCode","value":"model.save()","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"BZe54kYrlW"},{"type":"text","value":" and resume with ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"S51lAEf2EP"},{"type":"inlineCode","value":"model = PPO.load()","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"qHWZHUUS0T"},{"type":"text","value":" if your session is interrupted.","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"ValYlLZMIz"}],"key":"FDOO2UHKd8"}],"identifier":"a50ddbb4","label":"a50ddbb4","html_id":"a50ddbb4","key":"INMbMzhoOz"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":473813,"status":"ok","timestamp":1765084123265,"user":{"displayName":"Jianguo Zhao","userId":"09996222056778326224"},"user_tz":420},"id":"f145d31a","outputId":"801efb25-2483-4a77-b4b4-022139d575f1"},"children":[{"type":"code","lang":"python","executable":true,"value":"from stable_baselines3 import PPO\nfrom stable_baselines3.common.env_util import make_vec_env\nfrom stable_baselines3.common.evaluation import evaluate_policy\n\nclass AcrobotSwingUpWrapper(gym.Wrapper):\n    \"\"\"\n    Modified Acrobot wrapper for swing-up only (no balance).\n    Key changes:\n    1. Terminates when target height is reached\n    2. Reward function focuses on height achievement\n    3. No balance phase - episode ends at success\n    \"\"\"\n    def __init__(self,\n                 env,\n                 height_weight=10.0,\n                 control_cost=0.1,\n                 success_height=1.8,\n                 success_bonus=100.0,\n                 downward_penalty=5.0):\n        super().__init__(env)\n        self.height_weight = height_weight\n        self.control_cost = control_cost\n        self.success_height = success_height\n        self.success_bonus = success_bonus\n        self.downward_penalty = downward_penalty\n\n    def reset(self, **kwargs):\n        obs, info = self.env.reset(**kwargs)\n        return obs, info\n\n    def _is_downward(self, th1):\n        \"\"\"Check if the acrobot is in a downward configuration\"\"\"\n        e_th1_down = min(np.abs(th1), np.abs(th1 - 2*np.pi))\n        return e_th1_down < 0.5\n\n    def step(self, action):\n        obs, _, terminated, truncated, info = self.env.step(action)\n\n        # Extract state from observation\n        cos_th1, sin_th1, cos_th2, sin_th2, th1_dot, th2_dot = obs\n\n        # Recover angles\n        th1 = np.arctan2(sin_th1, cos_th1)\n\n        # Calculate tip height\n        height = -cos_th1 - (cos_th1 * cos_th2 - sin_th1 * sin_th2)\n\n        # Get control input\n        u = float(getattr(self.env.unwrapped, \"last_u\", 0.0))\n\n        # Swing-up reward function (no balance components)\n        # 1. Height reward (main objective)\n        height_reward = self.height_weight * height\n\n        # 2. Downward penalty (discourage staying down)\n        downward_cost = 0.0\n        if self._is_downward(th1):\n            downward_cost = self.downward_penalty\n\n        # 3. Control cost (energy efficiency)\n        control_penalty = self.control_cost * (u**2)\n\n        # Total reward (simplified for swing-up only)\n        reward = height_reward - downward_cost - control_penalty\n\n        # TERMINATE upon reaching target height (swing-up success)\n        if height >= self.success_height:\n            terminated = True\n            reward += self.success_bonus  # Large bonus for success\n\n        return obs, reward, terminated, truncated, info\n\n\n# Updated environment creation for swing-up only\ndef make_acrobot_swingup_env():\n    base_env = gym.make(\"Acrobot-v1\", max_episode_steps=500)  # Shorter episodes for swing-up\n    env = ContinuousAcrobotActionWrapper(base_env, torque_limit=5.0)\n    env = AcrobotSwingUpWrapper(\n        env,\n        height_weight=10.0,\n        control_cost=0.1,\n        success_height=1.8,  # Height threshold for success\n        success_bonus=100.0,\n        downward_penalty=5.0\n    )\n    return env\n\n# Train the model for swing-up only\nprint(\"Training the swing-up only policy...\")\nvec_env_swingup = make_vec_env(make_acrobot_swingup_env, n_envs=32)\nmodel_swingup = PPO(\"MlpPolicy\", vec_env_swingup, verbose=1,\n                    learning_rate=3e-4, n_steps=2048)\nmodel_swingup.learn(total_timesteps=500_000)  # Less timesteps needed for simpler task\nmodel_swingup.save(\"ppo_acrobot_swingup\")\nprint(\"Training complete!\")\n\n# Evaluate the trained policy\nenv_eval = make_acrobot_swingup_env()\nmean_reward, std_reward = evaluate_policy(model_swingup, env_eval, n_eval_episodes=10)\nprint(f\"Mean reward over 10 episodes: {mean_reward:.2f} ± {std_reward:.2f}\")\nenv_eval.close()","identifier":"f145d31a-code","enumerator":"17","html_id":"f145d31a-code","key":"glnreiPC1r"},{"type":"outputs","id":"PEsZmw9IYSMeLQWKiNZDG","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Training the swing-up only policy...\nUsing cuda device\n----------------------------------\n| rollout/           |           |\n|    ep_len_mean     | 496       |\n|    ep_rew_mean     | -9.31e+03 |\n| time/              |           |\n|    fps             | 5808      |\n|    iterations      | 1         |\n|    time_elapsed    | 11        |\n|    total_timesteps | 65536     |\n----------------------------------\n------------------------------------------\n| rollout/                |              |\n|    ep_len_mean          | 431          |\n|    ep_rew_mean          | -6.71e+03    |\n| time/                   |              |\n|    fps                  | 1853         |\n|    iterations           | 2            |\n|    time_elapsed         | 70           |\n|    total_timesteps      | 131072       |\n| train/                  |              |\n|    approx_kl            | 0.0045138393 |\n|    clip_fraction        | 0.0428       |\n|    clip_range           | 0.2          |\n|    entropy_loss         | -1.41        |\n|    explained_variance   | -0.00106     |\n|    learning_rate        | 0.0003       |\n|    loss                 | 9.45e+03     |\n|    n_updates            | 10           |\n|    policy_gradient_loss | -0.00354     |\n|    std                  | 0.989        |\n|    value_loss           | 5.08e+04     |\n------------------------------------------\n------------------------------------------\n| rollout/                |              |\n|    ep_len_mean          | 282          |\n|    ep_rew_mean          | -4.13e+03    |\n| time/                   |              |\n|    fps                  | 1514         |\n|    iterations           | 3            |\n|    time_elapsed         | 129          |\n|    total_timesteps      | 196608       |\n| train/                  |              |\n|    approx_kl            | 0.0055075577 |\n|    clip_fraction        | 0.06         |\n|    clip_range           | 0.2          |\n|    entropy_loss         | -1.39        |\n|    explained_variance   | 0.292        |\n|    learning_rate        | 0.0003       |\n|    loss                 | 5.73e+03     |\n|    n_updates            | 20           |\n|    policy_gradient_loss | -0.00509     |\n|    std                  | 0.967        |\n|    value_loss           | 2.98e+04     |\n------------------------------------------\n-----------------------------------------\n| rollout/                |             |\n|    ep_len_mean          | 215         |\n|    ep_rew_mean          | -3.19e+03   |\n| time/                   |             |\n|    fps                  | 1387        |\n|    iterations           | 4           |\n|    time_elapsed         | 188         |\n|    total_timesteps      | 262144      |\n| train/                  |             |\n|    approx_kl            | 0.005778214 |\n|    clip_fraction        | 0.0635      |\n|    clip_range           | 0.2         |\n|    entropy_loss         | -1.36       |\n|    explained_variance   | 0.59        |\n|    learning_rate        | 0.0003      |\n|    loss                 | 4.02e+03    |\n|    n_updates            | 30          |\n|    policy_gradient_loss | -0.00528    |\n|    std                  | 0.946       |\n|    value_loss           | 2.03e+04    |\n-----------------------------------------\n------------------------------------------\n| rollout/                |              |\n|    ep_len_mean          | 172          |\n|    ep_rew_mean          | -2.57e+03    |\n| time/                   |              |\n|    fps                  | 1320         |\n|    iterations           | 5            |\n|    time_elapsed         | 248          |\n|    total_timesteps      | 327680       |\n| train/                  |              |\n|    approx_kl            | 0.0071937316 |\n|    clip_fraction        | 0.0786       |\n|    clip_range           | 0.2          |\n|    entropy_loss         | -1.34        |\n|    explained_variance   | 0.752        |\n|    learning_rate        | 0.0003       |\n|    loss                 | 2.96e+03     |\n|    n_updates            | 40           |\n|    policy_gradient_loss | -0.00677     |\n|    std                  | 0.921        |\n|    value_loss           | 1.51e+04     |\n------------------------------------------\n-----------------------------------------\n| rollout/                |             |\n|    ep_len_mean          | 143         |\n|    ep_rew_mean          | -2.07e+03   |\n| time/                   |             |\n|    fps                  | 1281        |\n|    iterations           | 6           |\n|    time_elapsed         | 306         |\n|    total_timesteps      | 393216      |\n| train/                  |             |\n|    approx_kl            | 0.007908285 |\n|    clip_fraction        | 0.0892      |\n|    clip_range           | 0.2         |\n|    entropy_loss         | -1.31       |\n|    explained_variance   | 0.856       |\n|    learning_rate        | 0.0003      |\n|    loss                 | 2.54e+03    |\n|    n_updates            | 50          |\n|    policy_gradient_loss | -0.00814    |\n|    std                  | 0.893       |\n|    value_loss           | 1.06e+04    |\n-----------------------------------------\n-----------------------------------------\n| rollout/                |             |\n|    ep_len_mean          | 116         |\n|    ep_rew_mean          | -1.72e+03   |\n| time/                   |             |\n|    fps                  | 1254        |\n|    iterations           | 7           |\n|    time_elapsed         | 365         |\n|    total_timesteps      | 458752      |\n| train/                  |             |\n|    approx_kl            | 0.009587152 |\n|    clip_fraction        | 0.114       |\n|    clip_range           | 0.2         |\n|    entropy_loss         | -1.27       |\n|    explained_variance   | 0.911       |\n|    learning_rate        | 0.0003      |\n|    loss                 | 2.41e+03    |\n|    n_updates            | 60          |\n|    policy_gradient_loss | -0.011      |\n|    std                  | 0.858       |\n|    value_loss           | 7.05e+03    |\n-----------------------------------------\n-----------------------------------------\n| rollout/                |             |\n|    ep_len_mean          | 109         |\n|    ep_rew_mean          | -1.54e+03   |\n| time/                   |             |\n|    fps                  | 1234        |\n|    iterations           | 8           |\n|    time_elapsed         | 424         |\n|    total_timesteps      | 524288      |\n| train/                  |             |\n|    approx_kl            | 0.011041708 |\n|    clip_fraction        | 0.134       |\n|    clip_range           | 0.2         |\n|    entropy_loss         | -1.23       |\n|    explained_variance   | 0.945       |\n|    learning_rate        | 0.0003      |\n|    loss                 | 2.02e+03    |\n|    n_updates            | 70          |\n|    policy_gradient_loss | -0.0138     |\n|    std                  | 0.825       |\n|    value_loss           | 4.94e+03    |\n-----------------------------------------\nTraining complete!\n"},"children":[],"identifier":"f145d31a-outputs-0","html_id":"f145d31a-outputs-0","key":"l06OxE09M1"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/usr/local/lib/python3.12/dist-packages/stable_baselines3/common/evaluation.py:70: UserWarning: Evaluation environment is not wrapped with a ``Monitor`` wrapper. This may result in reporting modified episode lengths and rewards, if other wrappers happen to modify these. Consider wrapping environment first with ``Monitor`` wrapper.\n  warnings.warn(\n"},"children":[],"identifier":"f145d31a-outputs-1","html_id":"f145d31a-outputs-1","key":"tJ9SMeS2MM"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Mean reward over 10 episodes: -1576.56 ± 309.85\n"},"children":[],"identifier":"f145d31a-outputs-2","html_id":"f145d31a-outputs-2","key":"afwr6IDdHl"}],"identifier":"f145d31a-outputs","html_id":"f145d31a-outputs","key":"NvMqcR2xDc"}],"identifier":"f145d31a","label":"f145d31a","html_id":"f145d31a","key":"yGZn68MChW"},{"type":"block","kind":"notebook-content","data":{"id":"a9dc7a74"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize and Analyze the Trained Policy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OABZwykZMM"}],"key":"JjOzzuyPy9"}],"key":"W4Is34jHSI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The code below demonstrates the performance of the trained RL agent that learns the swing-up behavior. It includes:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x90ZLwuXIN"}],"key":"zTofY9kRKd"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Video Recording","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"erDQqldQ2d"}],"key":"PsJWmBHFQK"},{"type":"text","value":": Creates a video of the trained policy in action, showing the complete swing-up and balance behavior over a full episode","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HycCkQobZP"}],"key":"S6Li3c6MJX"}],"key":"VW9mOamrXZ"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Quantitative Analysis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RN3LJ7Y4FV"}],"key":"Z7f9JyPUy3"},{"type":"text","value":": Runs 5 evaluation episodes and plots for each:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mN1MUTOlWE"}],"key":"PnBOcTw53B"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Joint angles","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lJe9Au2QoX"}],"key":"AwnVci3e4d"},{"type":"text","value":" (θ₁ and θ₂) over time with target values indicated","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OUkTDWbEVw"}],"key":"BTE8A9Di1Z"}],"key":"NWdyvvth0k"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Tip height","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"nkNLuWVQYd"}],"key":"PuLI5yn8gb"},{"type":"text","value":" trajectory showing progression from downward to upright","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qwPNb7OopK"}],"key":"kaatKv8ABN"}],"key":"VlULqP7B2P"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Control input","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"OvuORRWlpi"}],"key":"IugN5bUHAM"},{"type":"text","value":" (torque) showing the agent’s learned control strategy","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"JhPqsHJVce"}],"key":"csYnarDL2w"}],"key":"j8ptO9LTDQ"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Reward per step","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gjXTUrPkOW"}],"key":"jVdCllaf6c"},{"type":"text","value":" demonstrating the multi-phase reward structure","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Uwa4EVZ7Ka"}],"key":"JuJhoNhndf"}],"key":"SZpSUJnSyz"}],"key":"vc2FUofBRn"}],"key":"YvYsRHpYlO"}],"key":"A7uzleEcnR"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"These visualizations help verify that the policy successfully learns the swing-up process.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Bd9yxoQezc"}],"key":"szAdpxPUqc"}],"identifier":"a9dc7a74","label":"a9dc7a74","html_id":"a9dc7a74","key":"CwLkWYFtvj"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/","height":258},"executionInfo":{"elapsed":612,"status":"ok","timestamp":1765084549689,"user":{"displayName":"Jianguo Zhao","userId":"09996222056778326224"},"user_tz":420},"id":"0415d9bb","outputId":"7c8ed5ca-b50c-44f6-b8c5-8ade6b31f798"},"children":[{"type":"code","lang":"python","executable":true,"value":"from stable_baselines3 import PPO\nfrom stable_baselines3.common.vec_env import VecVideoRecorder, DummyVecEnv\nimport gymnasium as gym\nfrom IPython.display import Video\n\n# Create environment wrapper for video recording\ndef make_acrobot_balance_env_video():\n    base_env = gym.make(\"Acrobot-v1\", render_mode=\"rgb_array\", max_episode_steps=1000)\n    env = ContinuousAcrobotActionWrapper(base_env, torque_limit=5.0)\n    env = AcrobotSwingUpWrapper(\n        env,\n        height_weight=10.0,\n        control_cost=0.1,\n        success_height=1.8,\n        success_bonus=100.0,\n        downward_penalty=5.0\n    )\n    return env\n\n# Load the trained model\nmodel = PPO.load(\"ppo_acrobot_swingup\")\n\n# Record video\nenv = DummyVecEnv([make_acrobot_balance_env_video])\nenv = VecVideoRecorder(env, \"videos/\",\n                       record_video_trigger=lambda x: x == 0,\n                       video_length=1000,\n                       name_prefix=\"acrobot_balance\")\n\nobs = env.reset()\nfor _ in range(5000):\n    action, _ = model.predict(obs, deterministic=True)\n    obs, reward, done, info = env.step(action)\n    if done[0]:\n        break\n\nenv.close()\n\n# Display the video\nVideo(\"videos/acrobot_swingup-step-0-to-step-1000.mp4\",embed=True, width=600)","identifier":"0415d9bb-code","enumerator":"18","html_id":"id-0415d9bb-code","key":"zozc4mASRp"},{"type":"outputs","id":"m94yq0sxwPcVIG71ZUxRt","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Moviepy - Building video /content/videos/acrobot_balance-step-0-to-step-1000.mp4.\nMoviepy - Writing video /content/videos/acrobot_balance-step-0-to-step-1000.mp4\n\n"},"children":[],"identifier":"0415d9bb-outputs-0","html_id":"id-0415d9bb-outputs-0","key":"yyebX9D8wj"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"                                                             "},"children":[],"identifier":"0415d9bb-outputs-1","html_id":"id-0415d9bb-outputs-1","key":"pSWJF5jf9S"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Moviepy - Done !\nMoviepy - video ready /content/videos/acrobot_balance-step-0-to-step-1000.mp4\n"},"children":[],"identifier":"0415d9bb-outputs-2","html_id":"id-0415d9bb-outputs-2","key":"ICL9i5HaCJ"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"\r"},"children":[],"identifier":"0415d9bb-outputs-3","html_id":"id-0415d9bb-outputs-3","key":"DdfgnnqNw7"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"<video controls  width=\"600\" >\n <source src=\"data:None;base64,videos/acrobot_swingup-step-0-to-step-1000.mp4\" type=\"None\">\n Your browser does not support the video tag.\n </video>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.Video object>","content_type":"text/plain"}}},"children":[],"identifier":"0415d9bb-outputs-4","html_id":"id-0415d9bb-outputs-4","key":"O84iUUwPzA"}],"identifier":"0415d9bb-outputs","html_id":"id-0415d9bb-outputs","key":"XHGnSTnNV8"}],"identifier":"0415d9bb","label":"0415d9bb","html_id":"id-0415d9bb","key":"BNne6aRrLt"},{"type":"block","kind":"notebook-code","data":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":3876,"status":"ok","timestamp":1765084615218,"user":{"displayName":"Jianguo Zhao","userId":"09996222056778326224"},"user_tz":420},"id":"e1f660dc","outputId":"c5fe97da-de80-444f-effc-4bc966be00b3"},"children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nfrom stable_baselines3 import PPO\nimport numpy as np\n\n# Create environment without rendering\ndef make_acrobot_balance_env_eval():\n    base_env = gym.make(\"Acrobot-v1\", max_episode_steps=1000)\n    env = ContinuousAcrobotActionWrapper(base_env, torque_limit=5.0)\n    env = AcrobotSwingUpWrapper(\n        env,\n        height_weight=10.0,\n        control_cost=0.1,\n        success_height=1.8,\n        success_bonus=100.0,\n        downward_penalty=5.0\n    )\n    return env\n\nmodel = PPO.load(\"ppo_acrobot_swingup\")\nenv = make_acrobot_balance_env_eval()\n\n# Run multiple episodes and collect data\nnum_episodes = 5\nfor ep in range(num_episodes):\n    obs, info = env.reset()\n    done = False\n    step_count = 0\n\n    # Storage for this episode\n    observations = []\n    actions = []\n    rewards = []\n\n    while not done and step_count < 1000:\n        action, _ = model.predict(obs, deterministic=True)\n        observations.append(obs)\n        actions.append(action)\n\n        obs, reward, terminated, truncated, info = env.step(action)\n        rewards.append(reward)\n        done = terminated or truncated\n        step_count += 1\n\n    # Convert to numpy arrays\n    observations = np.array(observations)\n    actions = np.array(actions)\n\n    # Extract angles from observations\n    cos_th1, sin_th1 = observations[:, 0], observations[:, 1]\n    cos_th2, sin_th2 = observations[:, 2], observations[:, 3]\n    th1 = np.arctan2(sin_th1, cos_th1)\n    th2 = np.arctan2(sin_th2, cos_th2)\n\n    # Calculate tip height\n    height = -cos_th1 - (cos_th1 * cos_th2 - sin_th1 * sin_th2)\n\n    # Plot results for this episode\n    fig, axes = plt.subplots(2, 2, figsize=(14, 10))\n\n    # Plot angles\n    axes[0, 0].plot(th1, label='θ₁')\n    axes[0, 0].plot(th2, label='θ₂')\n    axes[0, 0].axhline(y=np.pi, color='r', linestyle='--', alpha=0.5, label='θ₁ target (π)')\n    axes[0, 0].axhline(y=0, color='g', linestyle='--', alpha=0.5, label='θ₂ target (0)')\n    axes[0, 0].set_xlabel('Step')\n    axes[0, 0].set_ylabel('Angle (rad)')\n    axes[0, 0].set_title('Joint Angles')\n    axes[0, 0].legend()\n    axes[0, 0].grid(True)\n\n    # Plot tip height\n    axes[0, 1].plot(height)\n    axes[0, 1].axhline(y=2.0, color='r', linestyle='--', alpha=0.5, label='Max height (upright)')\n    axes[0, 1].set_xlabel('Step')\n    axes[0, 1].set_ylabel('Height')\n    axes[0, 1].set_title('Tip Height Over Time')\n    axes[0, 1].legend()\n    axes[0, 1].grid(True)\n\n    # Plot control actions\n    axes[1, 0].plot(actions)\n    axes[1, 0].axhline(y=5.0, color='r', linestyle='--', alpha=0.5, label='Torque limit')\n    axes[1, 0].axhline(y=-5.0, color='r', linestyle='--', alpha=0.5)\n    axes[1, 0].set_xlabel('Step')\n    axes[1, 0].set_ylabel('Torque (Nm)')\n    axes[1, 0].set_title('Control Input')\n    axes[1, 0].legend()\n    axes[1, 0].grid(True)\n\n    # Plot rewards\n    axes[1, 1].plot(rewards)\n    axes[1, 1].set_xlabel('Step')\n    axes[1, 1].set_ylabel('Reward')\n    axes[1, 1].set_title('Reward per Step')\n    axes[1, 1].grid(True)\n\n    plt.suptitle(f'Episode {ep+1}: {step_count} steps, Final reward: {rewards[-1]:.2f}')\n    plt.tight_layout()\n    plt.show()\n\n    print(f\"Episode {ep+1}: Steps = {step_count}, Total reward = {sum(rewards):.2f}\")\n\nenv.close()","identifier":"e1f660dc-code","enumerator":"19","html_id":"e1f660dc-code","key":"FR5VRwe5oX"},{"type":"outputs","id":"9SsR6juPqt4xVhhoeeYak","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3a09777a16204dbe758e7f96ebb4f9fa","path":"/3a09777a16204dbe758e7f96ebb4f9fa.png"},"text/plain":{"content":"<Figure size 1400x1000 with 4 Axes>","content_type":"text/plain"}}},"children":[],"identifier":"e1f660dc-outputs-0","html_id":"e1f660dc-outputs-0","key":"cJJmS0sc41"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Episode 1: Steps = 101, Total reward = -1575.67\n"},"children":[],"identifier":"e1f660dc-outputs-1","html_id":"e1f660dc-outputs-1","key":"KxNa8chDKK"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"110a3132bbd26d475ee8cc59f84d80c4","path":"/110a3132bbd26d475ee8cc59f84d80c4.png"},"text/plain":{"content":"<Figure size 1400x1000 with 4 Axes>","content_type":"text/plain"}}},"children":[],"identifier":"e1f660dc-outputs-2","html_id":"e1f660dc-outputs-2","key":"Smciza9SDM"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Episode 2: Steps = 85, Total reward = -1390.84\n"},"children":[],"identifier":"e1f660dc-outputs-3","html_id":"e1f660dc-outputs-3","key":"YILmTnCIjT"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"acd7ecd27d52fb4f2536007f18ce8654","path":"/acd7ecd27d52fb4f2536007f18ce8654.png"},"text/plain":{"content":"<Figure size 1400x1000 with 4 Axes>","content_type":"text/plain"}}},"children":[],"identifier":"e1f660dc-outputs-4","html_id":"e1f660dc-outputs-4","key":"RC0wR0GZOF"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Episode 3: Steps = 107, Total reward = -1574.65\n"},"children":[],"identifier":"e1f660dc-outputs-5","html_id":"e1f660dc-outputs-5","key":"Wy1ShfRK1R"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7b81deb52d34ecd91bab63cd5f20138e","path":"/7b81deb52d34ecd91bab63cd5f20138e.png"},"text/plain":{"content":"<Figure size 1400x1000 with 4 Axes>","content_type":"text/plain"}}},"children":[],"identifier":"e1f660dc-outputs-6","html_id":"e1f660dc-outputs-6","key":"m9iXdV60V7"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Episode 4: Steps = 102, Total reward = -1363.52\n"},"children":[],"identifier":"e1f660dc-outputs-7","html_id":"e1f660dc-outputs-7","key":"qsF5LyN3JU"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f2cbceed96a9837d52040d557f351106","path":"/f2cbceed96a9837d52040d557f351106.png"},"text/plain":{"content":"<Figure size 1400x1000 with 4 Axes>","content_type":"text/plain"}}},"children":[],"identifier":"e1f660dc-outputs-8","html_id":"e1f660dc-outputs-8","key":"p8VY7dn4Ov"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Episode 5: Steps = 115, Total reward = -1515.81\n"},"children":[],"identifier":"e1f660dc-outputs-9","html_id":"e1f660dc-outputs-9","key":"H8JrN9ZpSk"}],"identifier":"e1f660dc-outputs","html_id":"e1f660dc-outputs","key":"ynnT9VeX7O"}],"identifier":"e1f660dc","label":"e1f660dc","html_id":"e1f660dc","key":"FFNYDwqFiY"},{"type":"block","kind":"notebook-content","data":{"id":"24cec948"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 5.4 - Hybrid Policy to Swing Up and then Balance (5 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IFJ6WS7a8e"}],"identifier":"task-5-4-hybrid-policy-to-swing-up-and-then-balance-5-pts","label":"Task 5.4 - Hybrid Policy to Swing Up and then Balance (5 pts)","html_id":"task-5-4-hybrid-policy-to-swing-up-and-then-balance-5-pts","implicit":true,"key":"pZVMZ0u94N"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this task, you need to combine two trained PPO policies: a swing-up policy and a stabilizer policy. You may refer to lab 10 for the cart pole on how to do this.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IPpsTR3ojB"}],"key":"kbSiMvafOm"}],"identifier":"24cec948","label":"24cec948","html_id":"id-24cec948","key":"U0MMS3zwvR"},{"type":"block","kind":"notebook-code","data":{"id":"baeaf9ef"},"children":[{"type":"code","lang":"python","executable":true,"value":"#TODO: implement the missing parts","identifier":"baeaf9ef-code","enumerator":"20","html_id":"baeaf9ef-code","key":"C5YwuPcfEy"},{"type":"outputs","id":"tfQzGwmdMBPgBFgnI22dH","children":[],"identifier":"baeaf9ef-outputs","html_id":"baeaf9ef-outputs","key":"Eb3dChacLD"}],"identifier":"baeaf9ef","label":"baeaf9ef","html_id":"baeaf9ef","key":"U1EmHNNJ9L"},{"type":"block","kind":"notebook-content","data":{"id":"68796de1"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Task 6. Discussions (5 pts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XN3MO3LjFq"}],"identifier":"task-6-discussions-5-pts","label":"Task 6. Discussions (5 pts)","html_id":"task-6-discussions-5-pts","implicit":true,"key":"v6NiVe0J7A"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this Task, you will compare the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EsUWTGvEKk"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"model-based control","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a466X0R5vf"}],"key":"DbkQjepfoP"},{"type":"text","value":" (LQR / trajectory tracking / MPC) with the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cA7r6086Gq"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"RL-based control","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jrPSL2PhkS"}],"key":"uoOTsttgl5"},{"type":"text","value":" on the Acrobot system. Specifically, compare the hybrid model-based controller in Task 4 vs and the hybrid RL policy generated in task 5.3 by plotting the following:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mgsvXbZP4b"}],"key":"AUuiEaWyR3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Single comparative figure: control inputs vs time (overlay both controllers: model-based u_model(t) and RL-based u_RL(t), include legend)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Q2zTbeyNl7"}],"key":"UmcvVDKLcz"}],"key":"sRySYFW707"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comparative state trajectories vs time: overlay for θ₁(t), θ₂(t) showing both controllers","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"El0ZB2yVfK"}],"key":"kZJKs7T4DH"}],"key":"eYmarfEeMu"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tip (end-effector) height vs time: single figure with both controllers overlaid and optionally target upright height reference line","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YWkci8UrMy"}],"key":"RdIiwwUo7O"}],"key":"ciZPnvGgOv"}],"key":"T8dFOG1UTu"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"You can choose the best policy you have obtained in RL by playing with the reward function. Based on the results you have obtained, explain the difference for the two approaches: ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"c0k1axmg6M"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"model-based control","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"SLcYvrSqUL"}],"key":"kSmmy5Bbnx"},{"type":"text","value":" vs  ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ppYnv2XitW"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"RL-based control","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xttwB121e7"}],"key":"RcgHMDqACJ"},{"type":"text","value":".","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"fNnSnKgVjC"}],"key":"jtvNnDiZSH"},{"type":"thematicBreak","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"WlbC3fODma"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Submission Requirements:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"AQIdABDR7r"}],"key":"hZRidFQf6z"}],"key":"pL93sq9bUt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Complete this notebook with all tasks implemented and documented.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"s89FIWLg6q"}],"key":"attfPGU04J"}],"key":"APjTNN3byZ"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Written report addressing the discussion points in each task.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"kqq9TMWrfG"}],"key":"ipgEByi9EJ"}],"key":"q9nHQEHl2h"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Include quantitative comparisons with plots and performance metrics.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"sRlLlLyV6H"}],"key":"Cnne36p0Kb"}],"key":"eqxAFSjRGC"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reflect on lessons learned about control theory and reinforcement learning.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"TXtFsrW10R"}],"key":"XIvaV9hDeJ"}],"key":"Iw4cxJ2nkH"}],"key":"ZIiRvmUBo7"}],"identifier":"68796de1","label":"68796de1","html_id":"id-68796de1","key":"Bv4n4Ma4Qp"}],"key":"pCNoKROjT1"},"references":{"cite":{"order":[],"data":{}}}}